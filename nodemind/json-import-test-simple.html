<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JSONå¯¼å…¥ç®€å•æµ‹è¯•</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 600px;
            margin: 50px auto;
            padding: 20px;
            background: #f0f2f5;
        }
        
        .container {
            background: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .btn {
            background: #007bff;
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px 0;
        }
        
        .btn:hover {
            background: #0056b3;
        }
        
        .result {
            margin: 20px 0;
            padding: 15px;
            border-radius: 6px;
            font-family: monospace;
            white-space: pre-wrap;
        }
        
        .success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        .info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ§  JSONå¯¼å…¥ç®€å•æµ‹è¯•</h1>
        <p>æµ‹è¯•æ‚¨çš„JSONæ–‡ä»¶æ˜¯å¦å¯ä»¥æ­£å¸¸å¯¼å…¥</p>
        
        <input type="file" id="file-input" accept=".json" style="display: none;">
        <button class="btn" onclick="selectFile()">ğŸ“ é€‰æ‹©JSONæ–‡ä»¶æµ‹è¯•</button>
        
        <div id="result-area"></div>
    </div>

    <script>
        function selectFile() {
            document.getElementById('file-input').click();
        }
        
        function showResult(message, type = 'info') {
            const resultArea = document.getElementById('result-area');
            const div = document.createElement('div');
            div.className = `result ${type}`;
            div.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
            resultArea.appendChild(div);
            console.log(message);
        }
        
        function clearResults() {
            document.getElementById('result-area').innerHTML = '';
        }
        
        // å¤„ç†æ–‡ä»¶é€‰æ‹©
        document.getElementById('file-input').addEventListener('change', function(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            clearResults();
            showResult(`ğŸ“ é€‰æ‹©æ–‡ä»¶: ${file.name}`, 'info');
            showResult(`ğŸ“ æ–‡ä»¶å¤§å°: ${Math.round(file.size / 1024)} KB`, 'info');
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const content = e.target.result;
                    showResult(`ğŸ“„ æ–‡ä»¶è¯»å–æˆåŠŸï¼Œå†…å®¹é•¿åº¦: ${content.length} å­—ç¬¦`, 'info');
                    
                    // è§£æJSON
                    const jsonData = JSON.parse(content);
                    showResult('âœ… JSONè§£ææˆåŠŸ', 'success');
                    
                    // åˆ†æJSONç»“æ„
                    showResult('ğŸ” JSONç»“æ„åˆ†æ:', 'info');
                    showResult(`   - æ˜¯å¦æœ‰mindmap? ${!!jsonData.mindmap}`, 'info');
                    showResult(`   - æ˜¯å¦æœ‰documents? ${!!jsonData.documents}`, 'info');
                    showResult(`   - æ˜¯å¦æœ‰exportInfo? ${!!jsonData.exportInfo}`, 'info');
                    showResult(`   - æ˜¯å¦æœ‰meta? ${!!jsonData.meta}`, 'info');
                    showResult(`   - æ˜¯å¦æœ‰format? ${!!jsonData.format}`, 'info');
                    showResult(`   - æ˜¯å¦æœ‰data? ${!!jsonData.data}`, 'info');
                    
                    // æ£€æŸ¥å…·ä½“æ ¼å¼
                    if (jsonData.mindmap && jsonData.mindmap.data) {
                        showResult('ğŸ¯ æ£€æµ‹åˆ°ï¼šNodeMindé¡¹ç›®æ ¼å¼', 'success');
                        showResult(`   - æ€ç»´å¯¼å›¾åç§°: ${jsonData.mindmap.meta?.name || 'æœªå‘½å'}`, 'info');
                        showResult(`   - æ ¹èŠ‚ç‚¹ä¸»é¢˜: ${jsonData.mindmap.data.topic}`, 'info');
                        
                        if (jsonData.documents) {
                            const docCount = Object.keys(jsonData.documents).length;
                            showResult(`   - æ–‡æ¡£æ•°é‡: ${docCount}`, 'info');
                        }
                        
                        // è®¡ç®—èŠ‚ç‚¹æ•°é‡
                        function countNodes(node) {
                            let count = 1;
                            if (node.children && Array.isArray(node.children)) {
                                for (const child of node.children) {
                                    count += countNodes(child);
                                }
                            }
                            return count;
                        }
                        
                        const nodeCount = countNodes(jsonData.mindmap.data);
                        showResult(`   - èŠ‚ç‚¹æ€»æ•°: ${nodeCount}`, 'info');
                        
                        showResult('ğŸ‰ è¿™æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„NodeMindé¡¹ç›®æ–‡ä»¶ï¼', 'success');
                        showResult('ğŸ’¡ å»ºè®®ï¼šæ¸…é™¤æµè§ˆå™¨ç¼“å­˜åé‡æ–°å°è¯•å¯¼å…¥', 'info');
                        
                    } else if (jsonData.meta && jsonData.format && jsonData.data) {
                        showResult('ğŸ¯ æ£€æµ‹åˆ°ï¼šæ ‡å‡†æ€ç»´å¯¼å›¾æ ¼å¼', 'success');
                        showResult('ğŸ‰ æ–‡ä»¶æ ¼å¼æ­£ç¡®ï¼', 'success');
                        
                    } else if (jsonData.data && jsonData.data.id) {
                        showResult('ğŸ¯ æ£€æµ‹åˆ°ï¼šç›´æ¥èŠ‚ç‚¹æ•°æ®æ ¼å¼', 'success');
                        showResult('ğŸ‰ æ–‡ä»¶æ ¼å¼æ­£ç¡®ï¼', 'success');
                        
                    } else if (jsonData.id && jsonData.topic) {
                        showResult('ğŸ¯ æ£€æµ‹åˆ°ï¼šæ ¹èŠ‚ç‚¹æ ¼å¼', 'success');
                        showResult('ğŸ‰ æ–‡ä»¶æ ¼å¼æ­£ç¡®ï¼', 'success');
                        
                    } else {
                        showResult('âš ï¸ æ— æ³•è¯†åˆ«çš„JSONæ ¼å¼', 'error');
                        showResult('è¯·ç¡®ä¿é€‰æ‹©çš„æ˜¯NodeMindå¯¼å‡ºçš„æ–‡ä»¶', 'error');
                    }
                    
                } catch (error) {
                    showResult(`âŒ JSONè§£æå¤±è´¥: ${error.message}`, 'error');
                    
                    if (error instanceof SyntaxError) {
                        showResult('è¿™ä¸æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„JSONæ–‡ä»¶', 'error');
                    }
                }
            };
            
            reader.onerror = function() {
                showResult('âŒ æ–‡ä»¶è¯»å–å¤±è´¥', 'error');
            };
            
            reader.readAsText(file);
            
            // é‡ç½®è¾“å…¥
            event.target.value = '';
        });
        
        window.onload = function() {
            showResult('ğŸš€ æµ‹è¯•å·¥å…·å·²å‡†å¤‡å°±ç»ª', 'info');
            showResult('è¯·é€‰æ‹©æ‚¨çš„JSONæ–‡ä»¶è¿›è¡Œæµ‹è¯•', 'info');
        };
    </script>
</body>
</html> 