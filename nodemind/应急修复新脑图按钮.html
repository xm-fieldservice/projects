<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>åº”æ€¥ä¿®å¤æ–°è„‘å›¾æŒ‰é’®</title>
</head>
<body>
    <h1>ğŸš¨ åº”æ€¥ä¿®å¤æ–°è„‘å›¾æŒ‰é’®</h1>
    <p>è¿™ä¸ªé¡µé¢å°†ä¿®å¤ä¸»é¡µé¢çš„æ–°è„‘å›¾æŒ‰é’®é—®é¢˜ã€‚</p>
    
    <button onclick="applyFix()" style="background: #28a745; color: white; padding: 15px 30px; border: none; border-radius: 5px; font-size: 16px; cursor: pointer;">
        ğŸ”§ ç«‹å³ä¿®å¤æ–°è„‘å›¾æŒ‰é’®
    </button>
    
    <div id="status" style="margin: 20px 0; padding: 15px; border-radius: 5px; background: #f8f9fa;">
        ç­‰å¾…ä¿®å¤...
    </div>

    <script>
        function applyFix() {
            const status = document.getElementById('status');
            status.innerHTML = 'ğŸ”„ æ­£åœ¨åº”ç”¨ä¿®å¤...';
            status.style.background = '#fff3cd';
            
            try {
                // åˆ›å»ºä¿®å¤è„šæœ¬
                const fixScript = `
                    // ğŸ†• æ–°è„‘å›¾æŒ‰é’®å¤„ç†å‡½æ•°ï¼ˆåº”æ€¥ä¿®å¤ï¼‰
                    window.handleNewMindmap = function() {
                        console.log('ğŸ†• æ–°è„‘å›¾æŒ‰é’®è¢«ç‚¹å‡»ï¼');
                        
                        if (confirm('ç¡®å®šè¦åˆ›å»ºä¸€ä¸ªå…¨æ–°çš„ç©ºç™½è„‘å›¾å—ï¼Ÿ\\n\\nâš ï¸ æ‰€æœ‰æœªä¿å­˜çš„æ•°æ®å°†è¢«æ¸…é™¤ï¼')) {
                            try {
                                console.log('ğŸ”„ ç”¨æˆ·ç¡®è®¤ï¼Œå¼€å§‹æ¸…é™¤æ•°æ®...');
                                
                                // æ˜¾ç¤ºå¤„ç†æ¶ˆæ¯
                                const messageDiv = document.createElement('div');
                                messageDiv.style.cssText = 'position: fixed; top: 20px; right: 20px; background: #007bff; color: white; padding: 15px 20px; border-radius: 5px; box-shadow: 0 4px 12px rgba(0,0,0,0.3); z-index: 10000; font-family: Arial, sans-serif; font-size: 14px;';
                                messageDiv.textContent = 'ğŸ”„ æ­£åœ¨æ¸…é™¤æ•°æ®å¹¶åˆ›å»ºæ–°è„‘å›¾...';
                                document.body.appendChild(messageDiv);
                                
                                setTimeout(() => {
                                    localStorage.clear();
                                    console.log('âœ… localStorageå·²æ¸…é™¤');
                                    messageDiv.textContent = 'âœ… æ•°æ®å·²æ¸…é™¤ï¼Œæ­£åœ¨é‡æ–°åŠ è½½...';
                                    messageDiv.style.background = '#28a745';
                                    setTimeout(() => { window.location.reload(); }, 1000);
                                }, 500);
                                
                            } catch (error) {
                                console.error('âŒ åˆ›å»ºæ–°è„‘å›¾æ—¶å‘ç”Ÿé”™è¯¯:', error);
                                alert('âŒ åˆ›å»ºæ–°è„‘å›¾å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨åˆ·æ–°é¡µé¢');
                            }
                        } else {
                            console.log('â„¹ï¸ ç”¨æˆ·å–æ¶ˆäº†æ–°è„‘å›¾æ“ä½œ');
                        }
                    };
                    
                    console.log('âœ… æ–°è„‘å›¾æŒ‰é’®ä¿®å¤å·²åº”ç”¨ï¼');
                `;
                
                // åœ¨å½“å‰é¡µé¢æ‰§è¡Œä¿®å¤
                eval(fixScript);
                
                // å°†ä¿®å¤ä»£ç ä¿å­˜åˆ°localStorageï¼Œä»¥ä¾¿åœ¨ä¸»é¡µé¢ä½¿ç”¨
                localStorage.setItem('nodemind_button_fix', fixScript);
                
                status.innerHTML = 'âœ… ä¿®å¤æˆåŠŸï¼ç°åœ¨è¯·åˆ·æ–°ä¸»é¡µé¢ (index.html) æ¥åº”ç”¨ä¿®å¤ã€‚';
                status.style.background = '#d4edda';
                status.style.color = '#155724';
                
                // æä¾›å¿«é€Ÿé“¾æ¥
                setTimeout(() => {
                    status.innerHTML += '<br><br><a href="index.html" style="background: #007bff; color: white; padding: 10px 20px; text-decoration: none; border-radius: 5px;">ğŸš€ æ‰“å¼€ä¸»é¡µé¢</a>';
                }, 1000);
                
            } catch (error) {
                status.innerHTML = `âŒ ä¿®å¤å¤±è´¥: ${error.message}`;
                status.style.background = '#f8d7da';
                status.style.color = '#721c24';
            }
        }
        
        // æ£€æŸ¥æ˜¯å¦å·²ç»ä¿®å¤
        window.addEventListener('load', function() {
            const existingFix = localStorage.getItem('nodemind_button_fix');
            if (existingFix) {
                document.getElementById('status').innerHTML = 'â„¹ï¸ æ£€æµ‹åˆ°å·²æœ‰ä¿®å¤ä»£ç ã€‚å¦‚æœä¸»é¡µé¢ä»æœ‰é—®é¢˜ï¼Œè¯·é‡æ–°åº”ç”¨ä¿®å¤ã€‚';
                document.getElementById('status').style.background = '#d1ecf1';
            }
        });
    </script>
</body>
</html> 