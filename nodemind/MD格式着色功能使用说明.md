# MDæ ¼å¼ç€è‰²åŠŸèƒ½ä½¿ç”¨è¯´æ˜

## ğŸ¨ åŠŸèƒ½æ¦‚è¿°

MDæ ¼å¼ç€è‰²åŠŸèƒ½æ˜¯åŸºäºèŠ‚ç‚¹çš„MDå†…å®¹è‡ªåŠ¨ä¸ºè„‘å›¾èŠ‚ç‚¹åº”ç”¨é¢œè‰²çš„æ™ºèƒ½ç³»ç»Ÿã€‚è¯¥åŠŸèƒ½é€šè¿‡è§£æèŠ‚ç‚¹çš„MDæ ¼å¼å†…å®¹ï¼Œè¯†åˆ«å…¶ä¸­çš„çŠ¶æ€ã€ä¼˜å…ˆçº§ã€æ ‡ç­¾ç­‰ä¿¡æ¯ï¼Œè‡ªåŠ¨ä¸ºèŠ‚ç‚¹åº”ç”¨ç›¸åº”çš„é¢œè‰²ï¼Œæä¾›ç›´è§‚çš„è§†è§‰åé¦ˆã€‚

## ğŸ¯ æ ¸å¿ƒç‰¹æ€§

### 1. æ™ºèƒ½çŠ¶æ€è¯†åˆ«
- **å·²å®ŒæˆçŠ¶æ€** `âœ…` - è‡ªåŠ¨è¯†åˆ«åŒ…å«å®Œæˆæ ‡è®°çš„èŠ‚ç‚¹
- **è¿›è¡Œä¸­çŠ¶æ€** `ğŸ”„` - è¯†åˆ«æ­£åœ¨è¿›è¡Œçš„ä»»åŠ¡èŠ‚ç‚¹
- **å¾…å¤„ç†çŠ¶æ€** `ğŸ“‹` - è¯†åˆ«ç­‰å¾…å¼€å§‹çš„ä»»åŠ¡èŠ‚ç‚¹

### 2. ä¼˜å…ˆçº§ç€è‰²
- **é«˜ä¼˜å…ˆçº§** `ğŸ”´` - ç´§æ€¥é‡è¦ä»»åŠ¡çš„çº¢è‰²æ ‡è¯†
- **ä¸­ä¼˜å…ˆçº§** `ğŸŸ¡` - æ™®é€šä»»åŠ¡çš„é»„è‰²æ ‡è¯†  
- **ä½ä¼˜å…ˆçº§** `ğŸŸ¢` - å¯å»¶åä»»åŠ¡çš„ç»¿è‰²æ ‡è¯†

### 3. ç‰¹æ®Šæ ‡ç­¾è¯†åˆ«
- **å®Œæˆæ ‡ç­¾** `#å®Œæˆ` - åŒ…å«å®Œæˆæ ‡ç­¾çš„èŠ‚ç‚¹è‡ªåŠ¨å˜ç°
- **æ³¨å…¥æ ‡è®°** `[å·²æ³¨å…¥]` - å·²æ³¨å…¥å†…å®¹çš„èŠ‚ç‚¹æ ‡è¯†
- **æ ‡ç­¾èŠ‚ç‚¹** - ç‰¹æ®Šæ ‡ç­¾èŠ‚ç‚¹çš„ç‹¬ç‰¹é¢œè‰²

### 4. å®æ—¶æ›´æ–°
- å†…å®¹å˜æ›´æ—¶è‡ªåŠ¨é‡æ–°ç€è‰²
- çŠ¶æ€åˆ‡æ¢æ—¶ç«‹å³æ›´æ–°é¢œè‰²
- ä¸MDé€‚é…å™¨å®æ—¶åŒæ­¥

## ğŸ¨ é¢œè‰²æ–¹æ¡ˆ

| çŠ¶æ€/ç±»å‹ | èƒŒæ™¯è‰² | æ–‡å­—è‰² | é€‚ç”¨æ¡ä»¶ |
|-----------|--------|--------|----------|
| **å·²å®Œæˆ** | `#f5f5f5` (æµ…ç°) | `#6c757d` (æ·±ç°) | åŒ…å« `âœ…`ã€`#å®Œæˆ`ã€`[å·²æ³¨å…¥]` |
| **è¿›è¡Œä¸­** | `#fff3cd` (æµ…é»„) | `#856404` (æ·±é»„) | åŒ…å« `ğŸ”„` çŠ¶æ€ |
| **å¾…å¤„ç†** | `#d1ecf1` (æµ…è“) | `#0c5460` (æ·±è“) | åŒ…å« `ğŸ“‹` çŠ¶æ€ |
| **é«˜ä¼˜å…ˆçº§** | `#f8d7da` (æµ…çº¢) | `#721c24` (æ·±çº¢) | åŒ…å« `ğŸ”´` ä¼˜å…ˆçº§ |
| **ä¸­ä¼˜å…ˆçº§** | `#fff3cd` (æµ…é»„) | `#856404` (æ·±é»„) | åŒ…å« `ğŸŸ¡` ä¼˜å…ˆçº§ |
| **ä½ä¼˜å…ˆçº§** | `#d4edda` (æµ…ç»¿) | `#155724` (æ·±ç»¿) | åŒ…å« `ğŸŸ¢` ä¼˜å…ˆçº§ |
| **æ ‡ç­¾èŠ‚ç‚¹** | `#e2e3e5` (ç°è‰²) | `#383d41` (æ·±ç°) | ç‰¹æ®Šæ ‡ç­¾èŠ‚ç‚¹ |
| **æ™®é€šèŠ‚ç‚¹** | `#ffffff` (ç™½è‰²) | `#333333` (æ·±è‰²) | æ— ç‰¹æ®Šæ ‡è®° |

## ğŸ”§ ä½¿ç”¨æ–¹æ³•

### 1. è‡ªåŠ¨ç€è‰² 
```javascript
// ä¸ºæ‰€æœ‰èŠ‚ç‚¹åº”ç”¨åŸºäºMDå†…å®¹çš„é¢œè‰²
MDNodeColoringService.colorAllNodesByMDContent();
```

### 2. å•ä¸ªèŠ‚ç‚¹ç€è‰²
```javascript
// ä¸ºç‰¹å®šèŠ‚ç‚¹åº”ç”¨é¢œè‰²
MDNodeColoringService.colorNodeByMDContent('nodeId');
```

### 3. å†…å®¹å˜æ›´ç›‘å¬
```javascript
// å†…å®¹å˜æ›´æ—¶è‡ªåŠ¨é‡æ–°ç€è‰²
MDNodeColoringService.onNodeContentChanged('nodeId', newContent);
```

### 4. çŠ¶æ€åˆ‡æ¢
```javascript
// åˆ‡æ¢èŠ‚ç‚¹å®ŒæˆçŠ¶æ€
MDNodeColoringService.toggleNodeCompletion('nodeId');
```

### 5. è·å–çŠ¶æ€èŠ‚ç‚¹
```javascript
// è·å–æ‰€æœ‰å·²å®Œæˆçš„èŠ‚ç‚¹
const completedNodes = MDNodeColoringService.getNodesByStatus('completed');

// è·å–æ‰€æœ‰è¿›è¡Œä¸­çš„èŠ‚ç‚¹
const inProgressNodes = MDNodeColoringService.getNodesByStatus('inProgress');

// è·å–æ‰€æœ‰å¾…å¤„ç†çš„èŠ‚ç‚¹
const pendingNodes = MDNodeColoringService.getNodesByStatus('pending');
```

## ğŸ“ MDå†…å®¹æ ¼å¼ç¤ºä¾‹

### å·²å®Œæˆä»»åŠ¡
```markdown
# å®Œæˆçš„ä»»åŠ¡

**çŠ¶æ€:** å·²å®Œæˆ âœ…
**å®Œæˆæ—¶é—´:** 2024-12-17 10:30:00 ğŸ
**é¡¹ç›®æ ‡ç­¾:** #å®Œæˆ #é‡è¦

ä»»åŠ¡å·²æˆåŠŸå®Œæˆï¼Œæ‰€æœ‰éªŒæ”¶æ ‡å‡†éƒ½å·²æ»¡è¶³ã€‚
```

### è¿›è¡Œä¸­ä»»åŠ¡
```markdown
# æ­£åœ¨è¿›è¡Œçš„ä»»åŠ¡

**çŠ¶æ€:** è¿›è¡Œä¸­ ğŸ”„
**ä¼˜å…ˆçº§:** ä¸­ç­‰ ğŸŸ¡
**é¢„è®¡å®Œæˆ:** æœ¬å‘¨äº”

å½“å‰æ­£åœ¨å¼€å‘ä¸­ï¼Œè¿›åº¦è‰¯å¥½ã€‚

**å½“å‰æ­¥éª¤:**
- [x] éœ€æ±‚åˆ†æ
- [x] è®¾è®¡æ–¹æ¡ˆ
- [ ] ç¼–ç å®ç°
```

### é«˜ä¼˜å…ˆçº§ä»»åŠ¡
```markdown
# ç´§æ€¥ä»»åŠ¡

**ä¼˜å…ˆçº§:** é«˜ ğŸ”´
**ç´§æ€¥ç¨‹åº¦:** ç«‹å³å¤„ç†
**è´Ÿè´£äºº:** å¼€å‘å›¢é˜Ÿ

è¿™æ˜¯ä¸€ä¸ªé«˜ä¼˜å…ˆçº§ä»»åŠ¡ï¼Œéœ€è¦ç«‹å³å¤„ç†ã€‚

**å…³é”®è¦æ±‚:**
- å¿…é¡»åœ¨24å°æ—¶å†…å®Œæˆ
- æ¶‰åŠç³»ç»Ÿå®‰å…¨é—®é¢˜
- éœ€è¦å¤šéƒ¨é—¨åä½œ
```

## ğŸ¯ é›†æˆæ–¹å¼

### 1. åœ¨è„‘å›¾åˆå§‹åŒ–æ—¶é›†æˆ
```javascript
// åœ¨ mindmap_service.js ä¸­
import MDNodeColoringService from './md_node_coloring_service.js';

function initMindmaps() {
    // ... åˆå§‹åŒ–è„‘å›¾ä»£ç  ...
    
    // å»¶è¿Ÿåº”ç”¨ç€è‰²ï¼Œç¡®ä¿æ•°æ®å·²åŠ è½½
    setTimeout(() => {
        MDNodeColoringService.colorAllNodesByMDContent();
    }, 1000);
}
```

### 2. åœ¨å†…å®¹æ›´æ–°æ—¶é›†æˆ
```javascript
// åœ¨ node_service.js ä¸­
export function handleNodeContentChange(nodeId, newContent) {
    // ... å†…å®¹æ›´æ–°é€»è¾‘ ...
    
    // å†…å®¹å˜æ›´åé‡æ–°ç€è‰²
    setTimeout(() => {
        MDNodeColoringService.onNodeContentChanged(nodeId, newContent);
    }, 200);
}
```

## ğŸ¨ é¢œè‰²è¯†åˆ«é€»è¾‘

### ä¼˜å…ˆçº§é¡ºåº
1. **å®ŒæˆçŠ¶æ€** - æœ€é«˜ä¼˜å…ˆçº§ï¼ŒåŒ…å«ä»»ä½•å®Œæˆæ ‡è®°çš„èŠ‚ç‚¹éƒ½æ˜¾ç¤ºä¸ºç°è‰²
2. **çŠ¶æ€æ ‡è®°** - å…¶æ¬¡è¯†åˆ« `ğŸ”„`ã€`ğŸ“‹` ç­‰çŠ¶æ€ç¬¦å·
3. **ä¼˜å…ˆçº§æ ‡è®°** - æœ€åè¯†åˆ« `ğŸ”´`ã€`ğŸŸ¡`ã€`ğŸŸ¢` ç­‰ä¼˜å…ˆçº§ç¬¦å·
4. **é»˜è®¤é¢œè‰²** - æ— ä»»ä½•æ ‡è®°æ—¶ä½¿ç”¨é»˜è®¤ç™½è‰²

### è¯†åˆ«æ¡ä»¶
```javascript
// å®ŒæˆçŠ¶æ€è¯†åˆ«
function isCompletedNode(parsedData) {
    // çŠ¶æ€ç¬¦å·æ£€æŸ¥
    if (parsedData.relationships.status?.status?.[0]?.symbol === 'âœ…') {
        return true;
    }
    
    // æ ‡ç­¾æ£€æŸ¥
    if (parsedData.relationships.tags?.some(tag => 
        tag.includes('å®Œæˆ') || tag.includes('å·²å®Œæˆ'))) {
        return true;
    }
    
    // å†…å®¹æ£€æŸ¥
    if (parsedData.content.includes('**å®Œæˆæ—¶é—´:**') || 
        parsedData.content.includes('[å·²æ³¨å…¥]')) {
        return true;
    }
    
    return false;
}
```

## ğŸ”§ æµ‹è¯•å’Œè°ƒè¯•

### 1. ä½¿ç”¨æµ‹è¯•é¡µé¢
- æ‰“å¼€ `test-md-coloring-simple.html`
- ç‚¹å‡»"ğŸš€ å¼€å§‹æ¼”ç¤º"åˆå§‹åŒ–æµ‹è¯•ç¯å¢ƒ
- ç‚¹å‡»"ğŸ¨ åº”ç”¨ç€è‰²"æŸ¥çœ‹ç€è‰²æ•ˆæœ
- ç‚¹å‡»"ğŸ“Š æ˜¾ç¤ºç»Ÿè®¡"æŸ¥çœ‹ç€è‰²ç»Ÿè®¡

### 2. æ§åˆ¶å°è°ƒè¯•
```javascript
// æŸ¥çœ‹é¢œè‰²é…ç½®
console.log(MDNodeColoringService.NodeColors);

// æµ‹è¯•å•ä¸ªèŠ‚ç‚¹çš„é¢œè‰²åˆ¤æ–­
const color = MDNodeColoringService.determineNodeColor(mdContent, nodeData);

// è·å–ç‰¹å®šçŠ¶æ€çš„èŠ‚ç‚¹
const completedNodes = MDNodeColoringService.getNodesByStatus('completed');
```

### 3. å®æ—¶ç›‘æ§
```javascript
// ç›‘å¬ç€è‰²è¿‡ç¨‹
window.addEventListener('console', function(event) {
    if (event.detail.includes('ğŸ¨ [ç€è‰²æœåŠ¡]')) {
        console.log('ç€è‰²äº‹ä»¶:', event.detail);
    }
});
```

## ğŸ“‹ æœ€ä½³å®è·µ

### 1. MDå†…å®¹è§„èŒƒ
- ä½¿ç”¨æ ‡å‡†çš„çŠ¶æ€ç¬¦å·ï¼š`âœ…` `ğŸ”„` `ğŸ“‹`
- ä½¿ç”¨æ ‡å‡†çš„ä¼˜å…ˆçº§ç¬¦å·ï¼š`ğŸ”´` `ğŸŸ¡` `ğŸŸ¢`
- ä¿æŒMDæ ¼å¼çš„ä¸€è‡´æ€§
- ä½¿ç”¨è¯­ä¹‰åŒ–çš„æ ‡ç­¾åç§°

### 2. æ€§èƒ½ä¼˜åŒ–
- é¿å…é¢‘ç¹çš„å…¨é‡ç€è‰²æ“ä½œ
- ä½¿ç”¨èŠ‚ç‚¹å†…å®¹å˜æ›´ç›‘å¬è¿›è¡Œå¢é‡æ›´æ–°
- åˆç†è®¾ç½®ç€è‰²å»¶è¿Ÿæ—¶é—´
- æ‰¹é‡å¤„ç†å¤šä¸ªèŠ‚ç‚¹çš„ç€è‰²

### 3. ç”¨æˆ·ä½“éªŒ
- æä¾›æ¸…æ™°çš„é¢œè‰²å›¾ä¾‹è¯´æ˜
- ç¡®ä¿é¢œè‰²å¯¹æ¯”åº¦è¶³å¤Ÿ
- æ”¯æŒé¢œè‰²ç›²å‹å¥½çš„è®¾è®¡
- æä¾›ç€è‰²å¼€å…³é€‰é¡¹

## ğŸš€ æ‰©å±•åŠŸèƒ½

### 1. è‡ªå®šä¹‰é¢œè‰²æ–¹æ¡ˆ
```javascript
// æ‰©å±•é¢œè‰²é…ç½®
const customColors = {
    urgent: {
        background: '#dc3545',
        foreground: '#ffffff',
        border: '#c82333'
    }
};

// åˆå¹¶åˆ°ç°æœ‰é…ç½®
Object.assign(MDNodeColoringService.NodeColors, customColors);
```

### 2. æ–°å¢è¯†åˆ«è§„åˆ™
```javascript
// åœ¨ determineNodeColor å‡½æ•°ä¸­æ·»åŠ æ–°çš„è¯†åˆ«é€»è¾‘
if (parsedData.content.includes('**ç´§æ€¥:**')) {
    return NodeColors.urgent;
}
```

### 3. ç€è‰²äº‹ä»¶ç›‘å¬
```javascript
// æ·»åŠ ç€è‰²å®Œæˆäº‹ä»¶
function onColoringComplete(nodeId, colorConfig) {
    console.log(`èŠ‚ç‚¹ ${nodeId} ç€è‰²å®Œæˆ:`, colorConfig);
    // è§¦å‘è‡ªå®šä¹‰äº‹ä»¶
    window.dispatchEvent(new CustomEvent('nodeColored', {
        detail: { nodeId, colorConfig }
    }));
}
```

## ğŸ” æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **ç€è‰²ä¸ç”Ÿæ•ˆ**
   - æ£€æŸ¥ `window.nodeDatabase` æ˜¯å¦å­˜åœ¨
   - ç¡®è®¤èŠ‚ç‚¹MDå†…å®¹æ ¼å¼æ­£ç¡®
   - éªŒè¯ `window.mindmaps` å®ä¾‹å¯ç”¨

2. **é¢œè‰²æ˜¾ç¤ºé”™è¯¯**
   - æ£€æŸ¥MDå†…å®¹ä¸­çš„çŠ¶æ€ç¬¦å·
   - ç¡®è®¤é¢œè‰²ä¼˜å…ˆçº§é€»è¾‘
   - éªŒè¯jsMindçš„é¢œè‰²è®¾ç½®API

3. **æ€§èƒ½é—®é¢˜**
   - å‡å°‘å…¨é‡ç€è‰²é¢‘ç‡
   - ä½¿ç”¨å¢é‡æ›´æ–°æ–¹å¼
   - ä¼˜åŒ–MDå†…å®¹è§£æé€»è¾‘

### è°ƒè¯•æ–¹æ³•
```javascript
// å¯ç”¨è¯¦ç»†æ—¥å¿—
localStorage.setItem('mdColoringDebug', 'true');

// æŸ¥çœ‹èŠ‚ç‚¹é¢œè‰²åˆ¤æ–­è¿‡ç¨‹
MDNodeColoringService.determineNodeColor(content, nodeData);

// æ£€æŸ¥ç€è‰²ç»Ÿè®¡
const result = MDNodeColoringService.colorAllNodesByMDContent();
console.log('ç€è‰²ç»“æœ:', result);
```

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [MDæ ¼å¼é€‚é…å™¨ä½¿ç”¨è¯´æ˜](./MDé€‚é…å™¨ä½¿ç”¨è¯´æ˜.md)
- [NodeMindå¼€å‘æŒ‡å—](./NodeMindä½¿ç”¨æŒ‡å—.md)
- [æ•°æ®ç»“æ„ç»Ÿä¸€æ–¹æ¡ˆ](./æ•°æ®ç»“æ„ç»Ÿä¸€æ–¹æ¡ˆä½¿ç”¨è¯´æ˜.md)
- [å…³ç³»ç¬¦å·ç³»ç»Ÿ](./nodemind-relationship-symbols.md)

---

**æ³¨æ„:** è¯¥åŠŸèƒ½éœ€è¦é…åˆMDé€‚é…å™¨æœåŠ¡ä½¿ç”¨ï¼Œç¡®ä¿å·²æ­£ç¡®é›†æˆ `md_adapter_service.js` å’Œç›¸å…³ä¾èµ–ã€‚ 