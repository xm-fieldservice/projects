<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ” æ–°è„‘å›¾æŒ‰é’®å®Œæ•´è¯Šæ–­</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            margin: 20px; 
            background: #f5f5f5;
            line-height: 1.6;
        }
        .diagnostic-container {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            max-width: 1200px;
            margin: 0 auto;
        }
        .diagnostic-section {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .diagnostic-section h3 {
            margin-top: 0;
            color: #333;
        }
        .test-button {
            background: #007bff;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
            font-size: 14px;
        }
        .test-button:hover {
            background: #0056b3;
        }
        .test-button.success { background: #28a745; }
        .test-button.warning { background: #ffc107; color: #000; }
        .test-button.danger { background: #dc3545; }
        .status {
            margin: 10px 0;
            padding: 10px;
            border-radius: 5px;
            font-family: monospace;
        }
        .status.success { background: #d4edda; color: #155724; }
        .status.error { background: #f8d7da; color: #721c24; }
        .status.info { background: #d1ecf1; color: #0c5460; }
        .status.warning { background: #fff3cd; color: #856404; }
        #diagnostic-results {
            font-family: monospace;
            background: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
            white-space: pre-wrap;
            max-height: 400px;
            overflow-y: auto;
            border: 1px solid #dee2e6;
        }
        .two-column {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        .button-test-area {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
            border: 2px dashed #6c757d;
        }
        .code-block {
            background: #f1f3f4;
            padding: 10px;
            border-radius: 4px;
            font-family: monospace;
            font-size: 12px;
            border-left: 4px solid #007bff;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <div class="diagnostic-container">
        <h1>ğŸ” æ–°è„‘å›¾æŒ‰é’®å®Œæ•´è¯Šæ–­æŠ¥å‘Š</h1>
        
        <div class="diagnostic-section">
            <h3>ğŸ¯ è¯Šæ–­ç›®æ ‡</h3>
            <p>å…¨é¢æ£€æŸ¥æ–°è„‘å›¾æŒ‰é’®çš„æ‰€æœ‰ç›¸å…³ç»„ä»¶ï¼Œæ‰¾å‡ºæŒ‰é’®æ— ååº”çš„æ ¹æœ¬åŸå› ã€‚</p>
            <div class="status info">
                <strong>é—®é¢˜æè¿°ï¼š</strong>ç”¨æˆ·ç‚¹å‡»"æ–°è„‘å›¾"æŒ‰é’®æ²¡æœ‰ä»»ä½•ååº”ï¼Œç­‰å¾…äº†è¿‘ä¸€ä¸ªå°æ—¶ä»æ— æ³•è§£å†³ã€‚
            </div>
        </div>

        <div class="two-column">
            <div class="diagnostic-section">
                <h3>ğŸ§ª è‡ªåŠ¨è¯Šæ–­æµ‹è¯•</h3>
                <button class="test-button" onclick="runFullDiagnostic()">ğŸš€ è¿è¡Œå®Œæ•´è¯Šæ–­</button>
                <button class="test-button" onclick="testButtonExistence()">1ï¸âƒ£ æ£€æŸ¥æŒ‰é’®å­˜åœ¨</button>
                <button class="test-button" onclick="testEventBinding()">2ï¸âƒ£ æ£€æŸ¥äº‹ä»¶ç»‘å®š</button>
                <button class="test-button" onclick="testAppJsLoading()">3ï¸âƒ£ æ£€æŸ¥app.jsåŠ è½½</button>
                <button class="test-button" onclick="testFunctionExistence()">4ï¸âƒ£ æ£€æŸ¥å‡½æ•°å­˜åœ¨</button>
                <button class="test-button" onclick="testManualTrigger()">5ï¸âƒ£ æ‰‹åŠ¨è§¦å‘æµ‹è¯•</button>
                <button class="test-button warning" onclick="clearResults()">ğŸ—‘ï¸ æ¸…é™¤ç»“æœ</button>
            </div>

            <div class="diagnostic-section">
                <h3>ğŸ”§ æ‰‹åŠ¨æµ‹è¯•åŒºåŸŸ</h3>
                <div class="button-test-area">
                    <p><strong>è¿™é‡Œæ˜¯æ¨¡æ‹Ÿçš„æ–°è„‘å›¾æŒ‰é’®ï¼š</strong></p>
                    <button id="create_new_mindmap_button_test" class="test-button danger">ğŸ†• æ–°è„‘å›¾ (æµ‹è¯•ç‰ˆ)</button>
                    <p><strong>è¿™é‡Œæ˜¯çœŸå®çš„æ–°è„‘å›¾æŒ‰é’®ï¼š</strong></p>
                    <button id="create_new_mindmap_button" class="test-button success">ğŸ†• æ–°è„‘å›¾ (çœŸå®ç‰ˆ)</button>
                    <div id="manual-test-status" class="status info">ç­‰å¾…æ‰‹åŠ¨æµ‹è¯•...</div>
                </div>
            </div>
        </div>

        <div class="diagnostic-section">
            <h3>ğŸ“Š è¯Šæ–­ç»“æœ</h3>
            <div id="diagnostic-results"></div>
        </div>

        <div class="diagnostic-section">
            <h3>ğŸ” å‘ç°çš„é—®é¢˜æ±‡æ€»</h3>
            <div id="issues-summary"></div>
        </div>

        <div class="diagnostic-section">
            <h3>ğŸ’¡ ä¿®å¤å»ºè®®</h3>
            <div id="fix-suggestions"></div>
        </div>
    </div>

    <script>
        // è¯Šæ–­æ—¥å¿—ç³»ç»Ÿ
        let diagnosticLog = [];
        let foundIssues = [];
        
        function log(message, type = 'info') {
            const timestamp = new Date().toLocaleTimeString();
            const logEntry = `[${timestamp}] ${message}`;
            diagnosticLog.push(logEntry);
            
            const resultsDiv = document.getElementById('diagnostic-results');
            resultsDiv.textContent = diagnosticLog.join('\n');
            resultsDiv.scrollTop = resultsDiv.scrollHeight;
            
            console.log(logEntry);
        }

        function addIssue(issue, severity = 'warning') {
            foundIssues.push({issue, severity});
            updateIssuesSummary();
        }

        function updateIssuesSummary() {
            const summaryDiv = document.getElementById('issues-summary');
            if (foundIssues.length === 0) {
                summaryDiv.innerHTML = '<div class="status success">âœ… æš‚æœªå‘ç°é—®é¢˜</div>';
                return;
            }

            let html = '';
            foundIssues.forEach((item, index) => {
                const className = item.severity === 'error' ? 'error' : 'warning';
                const icon = item.severity === 'error' ? 'âŒ' : 'âš ï¸';
                html += `<div class="status ${className}">${icon} ${index + 1}. ${item.issue}</div>`;
            });
            summaryDiv.innerHTML = html;
        }

        // æµ‹è¯•1: æ£€æŸ¥æŒ‰é’®å­˜åœ¨
        function testButtonExistence() {
            log('=== æµ‹è¯•1: æ£€æŸ¥æŒ‰é’®å­˜åœ¨æ€§ ===');
            
            const button = document.getElementById('create_new_mindmap_button');
            if (!button) {
                log('âŒ æ‰¾ä¸åˆ°æ–°è„‘å›¾æŒ‰é’® (ID: create_new_mindmap_button)', 'error');
                addIssue('æ‰¾ä¸åˆ°æ–°è„‘å›¾æŒ‰é’®å…ƒç´ ', 'error');
                return false;
            }
            
            log('âœ… æ‰¾åˆ°æ–°è„‘å›¾æŒ‰é’®');
            log(`ğŸ“ æŒ‰é’®ä½ç½®: ${button.getBoundingClientRect().top}px from top`);
            log(`ğŸ“ æŒ‰é’®å¤§å°: ${button.offsetWidth}x${button.offsetHeight}px`);
            log(`ğŸ¨ æŒ‰é’®ç±»å: ${button.className}`);
            log(`ğŸ“ æŒ‰é’®æ–‡æœ¬: "${button.textContent.trim()}"`);
            log(`ğŸ‘ï¸ æŒ‰é’®å¯è§: ${button.offsetParent !== null}`);
            log(`ğŸš« æŒ‰é’®ç¦ç”¨: ${button.disabled}`);
            
            if (button.offsetParent === null) {
                addIssue('æŒ‰é’®ä¸å¯è§ (display: none æˆ– visibility: hidden)', 'error');
            }
            
            if (button.disabled) {
                addIssue('æŒ‰é’®è¢«ç¦ç”¨', 'warning');
            }
            
            return true;
        }

        // æµ‹è¯•2: æ£€æŸ¥äº‹ä»¶ç»‘å®š
        function testEventBinding() {
            log('=== æµ‹è¯•2: æ£€æŸ¥äº‹ä»¶ç»‘å®š ===');
            
            const button = document.getElementById('create_new_mindmap_button');
            if (!button) {
                log('âŒ æŒ‰é’®ä¸å­˜åœ¨ï¼Œæ— æ³•æ£€æŸ¥äº‹ä»¶ç»‘å®š');
                return false;
            }

            // æ£€æŸ¥onclickå±æ€§
            if (button.onclick) {
                log('âœ… å‘ç°onclickå±æ€§ç»‘å®š');
                log(`ğŸ“‹ onclickå‡½æ•°: ${button.onclick.toString().substring(0, 100)}...`);
            } else {
                log('âš ï¸ æ²¡æœ‰onclickå±æ€§ç»‘å®š');
            }

            // æ£€æŸ¥addEventListenerç»‘å®šï¼ˆæ— æ³•ç›´æ¥æ£€æµ‹ï¼Œä½†å¯ä»¥å°è¯•è§¦å‘ï¼‰
            log('ğŸ” å°è¯•æ£€æµ‹addEventListenerç»‘å®š...');
            
            // åˆ›å»ºä¸€ä¸ªæµ‹è¯•äº‹ä»¶
            let eventTriggered = false;
            const originalAddEventListener = button.addEventListener;
            
            // ä¸´æ—¶æ·»åŠ ä¸€ä¸ªç›‘å¬å™¨æ¥æ£€æµ‹æ˜¯å¦æœ‰å…¶ä»–ç›‘å¬å™¨
            const testHandler = () => { eventTriggered = true; };
            button.addEventListener('click', testHandler);
            
            // è§¦å‘ç‚¹å‡»äº‹ä»¶
            const clickEvent = new MouseEvent('click', {
                bubbles: true,
                cancelable: true,
                view: window
            });
            
            button.dispatchEvent(clickEvent);
            
            // ç§»é™¤æµ‹è¯•ç›‘å¬å™¨
            button.removeEventListener('click', testHandler);
            
            if (eventTriggered) {
                log('âœ… äº‹ä»¶ç³»ç»Ÿæ­£å¸¸å·¥ä½œ');
            } else {
                log('âŒ äº‹ä»¶ç³»ç»Ÿå¯èƒ½æœ‰é—®é¢˜');
                addIssue('äº‹ä»¶ç³»ç»Ÿæ— æ³•æ­£å¸¸å·¥ä½œ', 'error');
            }

            // æ£€æŸ¥å¸¸è§çš„äº‹ä»¶ç»‘å®šæ–¹å¼
            const commonEventProps = ['onclick', 'addEventListener'];
            let hasAnyBinding = false;
            
            if (button.onclick) hasAnyBinding = true;
            
            // å°è¯•æ£€æŸ¥æ˜¯å¦æœ‰é€šè¿‡addEventListenerç»‘å®šçš„äº‹ä»¶
            if (window.getEventListeners) {
                const listeners = window.getEventListeners(button);
                if (listeners && listeners.click && listeners.click.length > 0) {
                    log(`âœ… å‘ç° ${listeners.click.length} ä¸ªaddEventListenerç»‘å®š`);
                    hasAnyBinding = true;
                } else {
                    log('âš ï¸ æ²¡æœ‰å‘ç°addEventListenerç»‘å®š');
                }
            } else {
                log('â„¹ï¸ æ— æ³•æ£€æµ‹addEventListenerç»‘å®š (æµè§ˆå™¨é™åˆ¶)');
            }

            if (!hasAnyBinding) {
                addIssue('æŒ‰é’®æ²¡æœ‰ä»»ä½•äº‹ä»¶ç»‘å®š', 'error');
            }

            return hasAnyBinding;
        }

        // æµ‹è¯•3: æ£€æŸ¥app.jsåŠ è½½
        function testAppJsLoading() {
            log('=== æµ‹è¯•3: æ£€æŸ¥app.jsåŠ è½½çŠ¶æ€ ===');
            
            // æ£€æŸ¥scriptæ ‡ç­¾
            const appScript = document.querySelector('script[src*="app.js"]');
            if (!appScript) {
                log('âŒ æ²¡æœ‰æ‰¾åˆ°app.jsçš„scriptæ ‡ç­¾');
                addIssue('app.jsæœªè¢«å¼•å…¥åˆ°HTMLä¸­', 'error');
                return false;
            }
            
            log('âœ… æ‰¾åˆ°app.jsçš„scriptæ ‡ç­¾');
            log(`ğŸ“ Script src: ${appScript.src}`);
            log(`ğŸ“‹ Script type: ${appScript.type}`);
            
            // æ£€æŸ¥æ˜¯å¦æ˜¯æ¨¡å—
            if (appScript.type !== 'module') {
                log('âš ï¸ app.jsä¸æ˜¯ä½œä¸ºES6æ¨¡å—åŠ è½½');
                addIssue('app.jsåº”è¯¥ä½œä¸ºES6æ¨¡å—åŠ è½½ (type="module")', 'warning');
            }

            // æ£€æŸ¥æ¨¡å—æ˜¯å¦æˆåŠŸåŠ è½½ï¼ˆé€šè¿‡æ£€æŸ¥å…¨å±€å˜é‡æˆ–å‡½æ•°ï¼‰
            const moduleIndicators = [
                'window.mindmaps',
                'window.nodeDatabase', 
                'window.projectInfo',
                'window.currentMindmap'
            ];

            let loadedIndicators = 0;
            moduleIndicators.forEach(indicator => {
                try {
                    const value = eval(indicator);
                    if (value !== undefined) {
                        log(`âœ… æ‰¾åˆ°æ¨¡å—æŒ‡æ ‡: ${indicator}`);
                        loadedIndicators++;
                    } else {
                        log(`âš ï¸ æ¨¡å—æŒ‡æ ‡æœªå®šä¹‰: ${indicator}`);
                    }
                } catch (e) {
                    log(`âŒ æ¨¡å—æŒ‡æ ‡æ£€æŸ¥å¤±è´¥: ${indicator} - ${e.message}`);
                }
            });

            if (loadedIndicators === 0) {
                addIssue('app.jså¯èƒ½æ²¡æœ‰æˆåŠŸåŠ è½½æˆ–åˆå§‹åŒ–', 'error');
                return false;
            }

            log(`ğŸ“Š æ‰¾åˆ° ${loadedIndicators}/${moduleIndicators.length} ä¸ªæ¨¡å—æŒ‡æ ‡`);
            return true;
        }

        // æµ‹è¯•4: æ£€æŸ¥å‡½æ•°å­˜åœ¨
        function testFunctionExistence() {
            log('=== æµ‹è¯•4: æ£€æŸ¥ç›¸å…³å‡½æ•°å­˜åœ¨æ€§ ===');
            
            const functionsToCheck = [
                'createNewMindmap',
                'bindUIEventListeners', 
                'main',
                'showMessage'
            ];

            let foundFunctions = 0;
            functionsToCheck.forEach(funcName => {
                try {
                    const func = eval(funcName);
                    if (typeof func === 'function') {
                        log(`âœ… å‡½æ•°å­˜åœ¨: ${funcName}`);
                        foundFunctions++;
                    } else {
                        log(`âŒ å‡½æ•°ä¸å­˜åœ¨æˆ–ä¸æ˜¯å‡½æ•°: ${funcName}`);
                    }
                } catch (e) {
                    log(`âŒ å‡½æ•°æ£€æŸ¥å¤±è´¥: ${funcName} - ${e.message}`);
                }
            });

            // æ£€æŸ¥æ¨¡å—åŒ–å‡½æ•°ï¼ˆå¯èƒ½åœ¨å‘½åç©ºé—´ä¸­ï¼‰
            const moduleSpaces = ['window.uiController', 'window.mindmapService'];
            moduleSpaces.forEach(space => {
                try {
                    const obj = eval(space);
                    if (obj && typeof obj === 'object') {
                        log(`âœ… æ‰¾åˆ°æ¨¡å—ç©ºé—´: ${space}`);
                        Object.keys(obj).forEach(key => {
                            if (typeof obj[key] === 'function') {
                                log(`  ğŸ“‹ ${space}.${key} (å‡½æ•°)`);
                            }
                        });
                    }
                } catch (e) {
                    log(`âš ï¸ æ¨¡å—ç©ºé—´ä¸å­˜åœ¨: ${space}`);
                }
            });

            if (foundFunctions === 0) {
                addIssue('æ²¡æœ‰æ‰¾åˆ°ä»»ä½•ç›¸å…³å‡½æ•°', 'error');
            }

            return foundFunctions > 0;
        }

        // æµ‹è¯•5: æ‰‹åŠ¨è§¦å‘æµ‹è¯•
        function testManualTrigger() {
            log('=== æµ‹è¯•5: æ‰‹åŠ¨è§¦å‘æµ‹è¯• ===');
            
            const button = document.getElementById('create_new_mindmap_button');
            if (!button) {
                log('âŒ æŒ‰é’®ä¸å­˜åœ¨ï¼Œæ— æ³•è¿›è¡Œæ‰‹åŠ¨è§¦å‘æµ‹è¯•');
                return false;
            }

            log('ğŸ¯ å°è¯•æ‰‹åŠ¨è§¦å‘æŒ‰é’®ç‚¹å‡»...');
            
            try {
                // æ–¹æ³•1: ç›´æ¥è°ƒç”¨onclick
                if (button.onclick) {
                    log('ğŸ“ è°ƒç”¨onclickæ–¹æ³•...');
                    button.onclick();
                    log('âœ… onclickè°ƒç”¨å®Œæˆ');
                } else {
                    log('âš ï¸ æ²¡æœ‰onclickæ–¹æ³•å¯è°ƒç”¨');
                }

                // æ–¹æ³•2: è§¦å‘clickäº‹ä»¶
                log('ğŸ–±ï¸ è§¦å‘clickäº‹ä»¶...');
                const clickEvent = new MouseEvent('click', {
                    bubbles: true,
                    cancelable: true,
                    view: window
                });
                button.dispatchEvent(clickEvent);
                log('âœ… clickäº‹ä»¶è§¦å‘å®Œæˆ');

                // æ–¹æ³•3: ç›´æ¥è°ƒç”¨createNewMindmapå‡½æ•°ï¼ˆå¦‚æœå­˜åœ¨ï¼‰
                try {
                    if (typeof createNewMindmap === 'function') {
                        log('ğŸ”§ ç›´æ¥è°ƒç”¨createNewMindmapå‡½æ•°...');
                        createNewMindmap();
                        log('âœ… createNewMindmapè°ƒç”¨å®Œæˆ');
                    } else {
                        log('âš ï¸ createNewMindmapå‡½æ•°ä¸å­˜åœ¨');
                    }
                } catch (e) {
                    log(`âŒ è°ƒç”¨createNewMindmapå¤±è´¥: ${e.message}`);
                }

            } catch (error) {
                log(`âŒ æ‰‹åŠ¨è§¦å‘æµ‹è¯•å¤±è´¥: ${error.message}`);
                addIssue(`æ‰‹åŠ¨è§¦å‘æµ‹è¯•å¤±è´¥: ${error.message}`, 'error');
                return false;
            }

            return true;
        }

        // è¿è¡Œæ‰€æœ‰è¯Šæ–­
        function runFullDiagnostic() {
            log('ğŸš€ å¼€å§‹è¿è¡Œå®Œæ•´è¯Šæ–­...');
            log('');
            
            foundIssues = []; // é‡ç½®é—®é¢˜åˆ—è¡¨
            
            const tests = [
                testButtonExistence,
                testEventBinding, 
                testAppJsLoading,
                testFunctionExistence,
                testManualTrigger
            ];

            let passedTests = 0;
            tests.forEach((test, index) => {
                try {
                    const result = test();
                    if (result) passedTests++;
                    log('');
                } catch (error) {
                    log(`âŒ æµ‹è¯• ${index + 1} æ‰§è¡Œå¤±è´¥: ${error.message}`);
                    addIssue(`æµ‹è¯•æ‰§è¡Œå¤±è´¥: ${error.message}`, 'error');
                    log('');
                }
            });

            log('='.repeat(50));
            log(`ğŸ“Š è¯Šæ–­å®Œæˆ: ${passedTests}/${tests.length} é¡¹æµ‹è¯•é€šè¿‡`);
            log('='.repeat(50));

            // ç”Ÿæˆä¿®å¤å»ºè®®
            generateFixSuggestions();
        }

        // ç”Ÿæˆä¿®å¤å»ºè®®
        function generateFixSuggestions() {
            const suggestionsDiv = document.getElementById('fix-suggestions');
            let suggestions = [];

            if (foundIssues.length === 0) {
                suggestionsDiv.innerHTML = '<div class="status success">âœ… æœªå‘ç°é—®é¢˜ï¼ŒæŒ‰é’®åº”è¯¥æ­£å¸¸å·¥ä½œ</div>';
                return;
            }

            // åŸºäºå‘ç°çš„é—®é¢˜ç”Ÿæˆå»ºè®®
            foundIssues.forEach(item => {
                if (item.issue.includes('æ‰¾ä¸åˆ°æ–°è„‘å›¾æŒ‰é’®')) {
                    suggestions.push('æ£€æŸ¥HTMLä¸­æ˜¯å¦å­˜åœ¨id="create_new_mindmap_button"çš„æŒ‰é’®å…ƒç´ ');
                }
                if (item.issue.includes('app.jsæœªè¢«å¼•å…¥')) {
                    suggestions.push('åœ¨HTMLä¸­æ·»åŠ : &lt;script type="module" src="src/app.js"&gt;&lt;/script&gt;');
                }
                if (item.issue.includes('æ²¡æœ‰ä»»ä½•äº‹ä»¶ç»‘å®š')) {
                    suggestions.push('åœ¨app.jsçš„main()å‡½æ•°ä¸­æ·»åŠ : uiController.bindUIEventListeners()');
                }
                if (item.issue.includes('app.jså¯èƒ½æ²¡æœ‰æˆåŠŸåŠ è½½')) {
                    suggestions.push('æ£€æŸ¥æµè§ˆå™¨æ§åˆ¶å°æ˜¯å¦æœ‰JavaScripté”™è¯¯');
                    suggestions.push('ç¡®ä¿æ‰€æœ‰æ¨¡å—æ–‡ä»¶è·¯å¾„æ­£ç¡®');
                }
                if (item.issue.includes('æ²¡æœ‰æ‰¾åˆ°ä»»ä½•ç›¸å…³å‡½æ•°')) {
                    suggestions.push('æ£€æŸ¥ui_controller.jsä¸­æ˜¯å¦æœ‰createNewMindmapå’ŒbindUIEventListenerså‡½æ•°');
                }
            });

            // é€šç”¨å»ºè®®
            suggestions.push('æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…·ï¼ŒæŸ¥çœ‹Consoleæ ‡ç­¾é¡µçš„é”™è¯¯ä¿¡æ¯');
            suggestions.push('ç¡®ä¿æ‰€æœ‰JavaScriptæ–‡ä»¶éƒ½èƒ½æ­£å¸¸åŠ è½½');
            suggestions.push('æ£€æŸ¥ç½‘ç»œæ ‡ç­¾é¡µï¼Œç¡®è®¤æ²¡æœ‰404é”™è¯¯');

            let html = '';
            suggestions.forEach((suggestion, index) => {
                html += `<div class="code-block">ğŸ’¡ ${index + 1}. ${suggestion}</div>`;
            });

            suggestionsDiv.innerHTML = html;
        }

        // æ¸…é™¤ç»“æœ
        function clearResults() {
            diagnosticLog = [];
            foundIssues = [];
            document.getElementById('diagnostic-results').textContent = '';
            document.getElementById('issues-summary').innerHTML = '<div class="status info">ç­‰å¾…è¯Šæ–­...</div>';
            document.getElementById('fix-suggestions').innerHTML = '<div class="status info">ç­‰å¾…è¯Šæ–­...</div>';
            document.getElementById('manual-test-status').innerHTML = 'ç­‰å¾…æ‰‹åŠ¨æµ‹è¯•...';
            document.getElementById('manual-test-status').className = 'status info';
        }

        // ä¸ºæµ‹è¯•æŒ‰é’®ç»‘å®šäº‹ä»¶
        document.getElementById('create_new_mindmap_button_test').addEventListener('click', function() {
            document.getElementById('manual-test-status').innerHTML = 'âœ… æµ‹è¯•æŒ‰é’®ç‚¹å‡»æˆåŠŸï¼äº‹ä»¶ç³»ç»Ÿæ­£å¸¸å·¥ä½œã€‚';
            document.getElementById('manual-test-status').className = 'status success';
            log('âœ… æµ‹è¯•æŒ‰é’®ç‚¹å‡»æˆåŠŸï¼');
        });

        // ä¸ºçœŸå®æŒ‰é’®æ·»åŠ æµ‹è¯•ç›‘å¬å™¨
        const realButton = document.getElementById('create_new_mindmap_button');
        if (realButton) {
            realButton.addEventListener('click', function() {
                document.getElementById('manual-test-status').innerHTML = 'ğŸ‰ çœŸå®æŒ‰é’®ç‚¹å‡»æˆåŠŸï¼å¦‚æœæ²¡æœ‰å…¶ä»–ååº”ï¼Œè¯´æ˜createNewMindmapå‡½æ•°æœ‰é—®é¢˜ã€‚';
                document.getElementById('manual-test-status').className = 'status success';
                log('ğŸ‰ çœŸå®æŒ‰é’®ç‚¹å‡»äº‹ä»¶è¢«è§¦å‘ï¼');
            });
        }

        // é¡µé¢åŠ è½½å®Œæˆåçš„åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            log('ğŸš€ è¯Šæ–­ç³»ç»Ÿåˆå§‹åŒ–å®Œæˆ');
            log('ğŸ‘† ç‚¹å‡»"è¿è¡Œå®Œæ•´è¯Šæ–­"å¼€å§‹æ£€æŸ¥æ‰€æœ‰é—®é¢˜');
        });
    </script>
</body>
</html> 