# ä¸ªäººæ™ºèƒ½é—®ç­”ç³»ç»Ÿ v2.0 ä¿®æ­£åˆ†å—è§£è€¦æ–¹æ¡ˆ

## ğŸ¯ **é‡è¦ä¿®æ­£è¯´æ˜**

âŒ **ä¹‹å‰çš„é”™è¯¯åˆ†å—**ï¼š
- å°†ç¬”è®°å’Œé—®ç­”åˆ†æˆä¸¤ä¸ªç‹¬ç«‹å—
- å¿½ç•¥äº†éƒ¨ç½²ç®¡ç†åŠŸèƒ½

âœ… **ä¿®æ­£åçš„æ­£ç¡®åˆ†å—**ï¼š
- ç¬”è®°å’Œé—®ç­”æ˜¯**ç»Ÿä¸€æ¨¡å—**ï¼Œé€šè¿‡æ¨¡å¼åˆ‡æ¢
- å¢åŠ **éƒ¨ç½²ç®¡ç†å—**ï¼Œæ”¯æŒDockerå®¹å™¨åŒ–

---

## ğŸ“¦ **ä¿®æ­£åçš„3å¤§åŠŸèƒ½è§£è€¦å—**

### **ğŸ” å—1ï¼šç”¨æˆ·è®¤è¯å— (AuthBlock)**
**ç‹¬ç«‹èŒè´£**ï¼šå®Œæ•´çš„ç”¨æˆ·èº«ä»½ç®¡ç†ç³»ç»Ÿ

```
auth-block/
â”œâ”€â”€ auth.html      # ç‹¬ç«‹ç™»å½•ç•Œé¢
â”œâ”€â”€ auth.css       # è®¤è¯ç•Œé¢æ ·å¼  
â””â”€â”€ auth.js        # å®Œæ•´è®¤è¯é€»è¾‘
```

**åŠŸèƒ½èŒƒå›´**ï¼š
- âœ… ç™»å½•ç•Œé¢æ¸²æŸ“
- âœ… ç”¨æˆ·åå¯†ç éªŒè¯
- âœ… Tokenå­˜å‚¨ç®¡ç†
- âœ… æ¼”ç¤ºæ¨¡å¼åˆ‡æ¢
- âœ… ç™»å½•çŠ¶æ€æ£€æŸ¥

**å¯¹å¤–æ¥å£**ï¼š
```javascript
window.AuthBlock = {
    /**
     * æ˜¾ç¤ºç™»å½•ç•Œé¢
     * @returns {void}
     */
    showLoginUI: () => {
        // å®ç°ç™»å½•UIæ˜¾ç¤ºé€»è¾‘
    },

    /**
     * ç”¨æˆ·ç™»å½•
     * @param {string} username - ç”¨æˆ·å
     * @param {string} password - å¯†ç   
     * @returns {Promise<AuthResult>}
     */
    login: async (username, password) => {
        // è¿”å›æ ¼å¼ï¼š
        return {
            success: true|false,
            data: {
                userId: "string",
                username: "string", 
                token: "string",
                role: "admin|user|demo",
                expiresAt: "2024-12-31T23:59:59Z"
            },
            error: "é”™è¯¯ä¿¡æ¯" // ä»…å½“success=falseæ—¶å­˜åœ¨
        };
    },

    /**
     * è·å–å½“å‰ç”¨æˆ·ä¿¡æ¯
     * @returns {UserInfo|null}
     */
    getCurrentUser: () => {
        // è¿”å›æ ¼å¼ï¼š
        return {
            userId: "string",
            username: "string",
            role: "admin|user|demo",
            loginTime: "2024-12-31T10:30:00Z"
        } || null;
    },

    /**
     * æ£€æŸ¥ç™»å½•çŠ¶æ€
     * @returns {boolean}
     */
    isLoggedIn: () => {
        return true|false;
    },

    /**
     * ç”¨æˆ·ç™»å‡º
     * @returns {LogoutResult}
     */
    logout: () => {
        // è¿”å›æ ¼å¼ï¼š
        return {
            success: true|false,
            message: "ç™»å‡ºæˆåŠŸ" || "ç™»å‡ºå¤±è´¥åŸå› "
        };
    },

    /**
     * å¯ç”¨æ¼”ç¤ºæ¨¡å¼
     * @returns {DemoResult}
     */
    enableDemoMode: () => {
        return {
            success: true,
            data: {
                userId: "demo_user",
                username: "æ¼”ç¤ºç”¨æˆ·",
                role: "demo",
                limitations: ["æ— æ³•ä¿å­˜åˆ°äº‘ç«¯", "ä¼šè¯æ—¶é•¿30åˆ†é’Ÿ"]
            }
        };
    }
};
```

---

### **ğŸ¤–ğŸ“ å—2ï¼šé—®ç­”ç¬”è®°ç»Ÿä¸€å— (QANoteBlock)**
**ç‹¬ç«‹èŒè´£**ï¼šå®Œæ•´çš„æ™ºèƒ½é—®ç­”+ç¬”è®°ç®¡ç†ç»Ÿä¸€ç³»ç»Ÿ

```
qa-note-block/
â”œâ”€â”€ qa-note.html   # ç»Ÿä¸€ç•Œé¢ï¼ˆé—®ç­”+ç¬”è®°æ¨¡å¼åˆ‡æ¢ï¼‰
â”œâ”€â”€ qa-note.css    # ç»Ÿä¸€æ ·å¼
â””â”€â”€ qa-note.js     # ç»Ÿä¸€é€»è¾‘
```

**åŠŸèƒ½èŒƒå›´**ï¼š
- âœ… **ç»Ÿä¸€è¾“å…¥ç•Œé¢**ï¼štitle-input, content-input, tag-input
- âœ… **æ¨¡å¼åˆ‡æ¢**ï¼šé—®ç­”æ¨¡å¼ â†” ç¬”è®°æ¨¡å¼
- âœ… **é—®ç­”åŠŸèƒ½**ï¼šAIæ™ºèƒ½ä½“é€‰æ‹©ã€åç«¯APIé€šä¿¡ã€ç­”æ¡ˆæ˜¾ç¤º
- âœ… **ç¬”è®°åŠŸèƒ½**ï¼šæœ¬åœ°å­˜å‚¨ã€æ ‡ç­¾ç®¡ç†ã€æœåŠ¡å™¨ä¾§çš„Markdownå¯¼å‡º
- âœ… **è‡ªåŠ¨ä¿å­˜**ï¼šé—®ç­”ç»“æœè‡ªåŠ¨ä¿å­˜ä¸ºæœ¬åœ°é€‰æ‹©çš„ç¬”è®°ï¼ˆMDæ–‡æ¡£ï¼‰ï¼ŒæœåŠ¡å™¨ä¾§çš„MDæ–‡æ¡£å¯¼å‡ºã€‚

**å¯¹å¤–æ¥å£**ï¼š
```javascript
window.QANoteBlock = {
    /**
     * æ˜¾ç¤ºç»Ÿä¸€ç•Œé¢
     * @param {string} defaultMode - é»˜è®¤æ¨¡å¼ 'qa'|'note'
     * @returns {void}
     */
    showQANoteUI: (defaultMode = 'qa') => {
        // å®ç°ç•Œé¢æ˜¾ç¤ºé€»è¾‘
    },

    /**
     * åˆ‡æ¢æ¨¡å¼
     * @param {string} mode - 'qa'|'note'
     * @returns {ModeResult}
     */
    switchMode: (mode) => {
        if (!['qa', 'note'].includes(mode)) {
            return {
                success: false,
                error: "æ— æ•ˆæ¨¡å¼ï¼Œå¿…é¡»æ˜¯ 'qa' æˆ– 'note'"
            };
        }
        return {
            success: true,
            data: {
                currentMode: mode,
                uiChanges: ["æ˜¾ç¤º/éšè—AIæ™ºèƒ½ä½“é€‰æ‹©", "æ›´æ”¹æäº¤æŒ‰é’®æ–‡å­—"]
            }
        };
    },

    /**
     * å‘é€é—®é¢˜ï¼ˆé—®ç­”æ¨¡å¼ï¼‰
     * @param {QuestionData} questionData
     * @returns {Promise<QAResult>}
     */
    askQuestion: async (questionData) => {
        // è¾“å…¥æ ¼å¼éªŒè¯
        const required = ['title', 'content', 'agentId'];
        for (let field of required) {
            if (!questionData[field]) {
                return {
                    success: false,
                    error: `ç¼ºå°‘å¿…éœ€å­—æ®µ: ${field}`
                };
            }
        }

        // è¿”å›æ ¼å¼ï¼š
        return {
            success: true|false,
            data: {
                questionId: "uuid",
                answer: "AIå›ç­”å†…å®¹",
                agentUsed: "deepseek|gpt4|claude",
                tokensUsed: 1500,
                responseTime: 2.3, // ç§’
                timestamp: "2024-12-31T10:30:00Z",
                autoSaved: true|false // æ˜¯å¦è‡ªåŠ¨ä¿å­˜ä¸ºç¬”è®°
            },
            error: "é”™è¯¯ä¿¡æ¯" // ä»…å½“success=falseæ—¶å­˜åœ¨
        };
    },

    /**
     * ä¿å­˜ç¬”è®°ï¼ˆç¬”è®°æ¨¡å¼ï¼‰
     * @param {NoteData} noteData
     * @returns {Promise<SaveResult>}
     */
    saveNote: async (noteData) => {
        // è¾“å…¥æ ¼å¼ï¼š
        const input = {
            title: "string", // å¿…éœ€
            content: "string", // å¿…éœ€
            tags: ["æ ‡ç­¾1", "æ ‡ç­¾2"], // å¯é€‰
            category: "string" // å¯é€‰
        };

        // è¿”å›æ ¼å¼ï¼š
        return {
            success: true|false,
            data: {
                noteId: "uuid",
                savedAt: "2024-12-31T10:30:00Z",
                storageType: "localStorage|cloud",
                fileDownloaded: true|false,
                backupCreated: true|false
            },
            error: "é”™è¯¯ä¿¡æ¯"
        };
    },

    /**
     * æœç´¢å†…å®¹
     * @param {string} keyword - æœç´¢å…³é”®è¯
     * @param {SearchOptions} options - æœç´¢é€‰é¡¹
     * @returns {SearchResult}
     */
    searchContent: (keyword, options = {}) => {
        // æœç´¢é€‰é¡¹ï¼š
        const searchOptions = {
            type: "all|qa|note", // æœç´¢ç±»å‹
            dateRange: {
                start: "2024-01-01",
                end: "2024-12-31"
            },
            tags: ["æ ‡ç­¾ç­›é€‰"],
            limit: 50
        };

        // è¿”å›æ ¼å¼ï¼š
        return {
            success: true,
            data: {
                results: [
                    {
                        id: "uuid",
                        type: "qa|note",
                        title: "æ ‡é¢˜",
                        content: "å†…å®¹ç‰‡æ®µ...",
                        tags: ["æ ‡ç­¾"],
                        createdAt: "2024-12-31T10:30:00Z",
                        relevanceScore: 0.95
                    }
                ],
                totalCount: 23,
                searchTime: 0.15 // ç§’
            }
        };
    },

    /**
     * å¯¼å‡ºç¬”è®°æœ¬
     * @param {ExportOptions} options - å¯¼å‡ºé€‰é¡¹
     * @returns {Promise<ExportResult>}
     */
    exportNotebook: async (options = {}) => {
        // å¯¼å‡ºé€‰é¡¹ï¼š
        const exportOptions = {
            format: "markdown|pdf|json",
            includeQA: true,
            includeNotes: true,
            dateRange: {
                start: "2024-01-01", 
                end: "2024-12-31"
            }
        };

        // è¿”å›æ ¼å¼ï¼š
        return {
            success: true,
            data: {
                filename: "æˆ‘çš„ç¬”è®°æœ¬_20241231.md",
                fileSize: "2.5MB",
                itemCount: 156,
                downloadUrl: "blob:...",
                exportTime: "2024-12-31T10:30:00Z"
            }
        };
    },

    /**
     * æ¸…ç©ºè¾“å…¥
     * @returns {void}
     */
    clearInputs: () => {
        // æ¸…ç©ºæ‰€æœ‰è¾“å…¥æ¡†å¹¶é‡ç½®çŠ¶æ€
    }
};
```

**æ¨¡å¼åˆ‡æ¢é€»è¾‘**ï¼š
```javascript
// åœ¨åŒä¸€ç•Œé¢å†…åˆ‡æ¢æ¨¡å¼
function switchMode(mode) {
    if (mode === 'qa') {
        // æ˜¾ç¤ºAIæ™ºèƒ½ä½“é€‰æ‹©
        document.getElementById('agent-selector').style.display = 'block';
        document.getElementById('submit-btn').textContent = 'å‘é€é—®é¢˜';
    } else if (mode === 'note') {
        // éšè—AIæ™ºèƒ½ä½“é€‰æ‹©
        document.getElementById('agent-selector').style.display = 'none';
        document.getElementById('submit-btn').textContent = 'ä¿å­˜ç¬”è®°';
    }
}
```

---

### **ğŸ¨ å—3ï¼šç•Œé¢åè°ƒå— (UIBlock)**  
**ç‹¬ç«‹èŒè´£**ï¼šå„åŠŸèƒ½å—çš„ç•Œé¢åè°ƒç³»ç»Ÿ

```
ui-block/
â”œâ”€â”€ index.html     # ä¸»ç•Œé¢å®¹å™¨
â”œâ”€â”€ main.css       # ç»Ÿä¸€æ ·å¼åè°ƒ
â””â”€â”€ main.js        # ç•Œé¢åˆ‡æ¢é€»è¾‘
```

**åŠŸèƒ½èŒƒå›´**ï¼š
- âœ… ä¸»ç•Œé¢å®¹å™¨ç®¡ç†
- âœ… åŠŸèƒ½å—åˆ‡æ¢åè°ƒï¼ˆè®¤è¯â†’é—®ç­”ç¬”è®°ï¼‰
- âœ… ç»Ÿä¸€æ¶ˆæ¯æç¤º
- âœ… å“åº”å¼å¸ƒå±€æ§åˆ¶
- âœ… å…¨å±€çŠ¶æ€åŒæ­¥

**å¯¹å¤–æ¥å£**ï¼š
```javascript
window.UIBlock = {
    /**
     * åˆ‡æ¢åˆ°æŒ‡å®šåŠŸèƒ½å—
     * @param {string} blockName - 'auth'|'qa-note'
     * @param {object} options - åˆ‡æ¢é€‰é¡¹
     * @returns {SwitchResult}
     */
    switchToBlock: (blockName, options = {}) => {
        const validBlocks = ['auth', 'qa-note'];
        if (!validBlocks.includes(blockName)) {
            return {
                success: false,
                error: `æ— æ•ˆçš„å—åç§°ï¼Œå¿…é¡»æ˜¯: ${validBlocks.join(', ')}`
            };
        }

        return {
            success: true,
            data: {
                fromBlock: "previous_block",
                toBlock: blockName,
                switchTime: "2024-12-31T10:30:00Z",
                animationDuration: 300 // æ¯«ç§’
            }
        };
    },

    /**
     * æ˜¾ç¤ºå…¨å±€æ¶ˆæ¯
     * @param {string} text - æ¶ˆæ¯æ–‡æœ¬
     * @param {string} type - æ¶ˆæ¯ç±»å‹
     * @param {MessageOptions} options - æ¶ˆæ¯é€‰é¡¹
     * @returns {MessageResult}
     */
    showMessage: (text, type, options = {}) => {
        const validTypes = ['success', 'error', 'warning', 'info'];
        if (!validTypes.includes(type)) {
            return {
                success: false,
                error: `æ— æ•ˆçš„æ¶ˆæ¯ç±»å‹ï¼Œå¿…é¡»æ˜¯: ${validTypes.join(', ')}`
            };
        }

        const messageOptions = {
            duration: 3000, // æ˜¾ç¤ºæ—¶é•¿(æ¯«ç§’)
            closable: true, // æ˜¯å¦å¯å…³é—­
            position: 'top-right', // æ˜¾ç¤ºä½ç½®
            icon: true // æ˜¯å¦æ˜¾ç¤ºå›¾æ ‡
        };

        return {
            success: true,
            data: {
                messageId: "uuid",
                displayedAt: "2024-12-31T10:30:00Z",
                willCloseAt: "2024-12-31T10:30:03Z"
            }
        };
    },

    /**
     * è·å–å½“å‰æ´»è·ƒå—
     * @returns {string}
     */
    getCurrentBlock: () => {
        return "auth"|"qa-note";
    },

    /**
     * åˆå§‹åŒ–ç•Œé¢
     * @param {InitOptions} options - åˆå§‹åŒ–é€‰é¡¹
     * @returns {Promise<InitResult>}
     */
    initialize: async (options = {}) => {
        const initOptions = {
            theme: "light|dark|auto",
            language: "zh-CN|en-US",
            responsive: true,
            checkAuthOnStart: true
        };

        return {
            success: true,
            data: {
                initializedAt: "2024-12-31T10:30:00Z",
                initialBlock: "auth"|"qa-note",
                theme: "light",
                userAgent: "browser_info",
                performance: {
                    loadTime: 1.2, // ç§’
                    memoryUsage: "15.6MB"
                }
            }
        };
    }
};
```

---

### **ğŸ³ å—4ï¼šéƒ¨ç½²ç®¡ç†å— (DeployBlock)**
**ç‹¬ç«‹èŒè´£**ï¼šDockerå®¹å™¨åŒ–éƒ¨ç½²å’Œç³»ç»Ÿç®¡ç†

```
deploy-block/
â”œâ”€â”€ docker-compose.yml    # Dockerå®¹å™¨ç¼–æ’
â”œâ”€â”€ Dockerfile.frontend   # å‰ç«¯å®¹å™¨é…ç½®
â”œâ”€â”€ Dockerfile.backend    # åç«¯å®¹å™¨é…ç½®
â”œâ”€â”€ deploy.sh            # ä¸€é”®éƒ¨ç½²è„šæœ¬
â”œâ”€â”€ nginx.conf           # Nginxé…ç½®
â””â”€â”€ deploy.js            # éƒ¨ç½²çŠ¶æ€ç›‘æ§
```

**åŠŸèƒ½èŒƒå›´**ï¼š
- âœ… **å®¹å™¨åŒ–éƒ¨ç½²**ï¼šFrontend + Backend + Database
- âœ… **æœåŠ¡ç›‘æ§**ï¼šå®¹å™¨çŠ¶æ€ã€å¥åº·æ£€æŸ¥
- âœ… **é…ç½®ç®¡ç†**ï¼šç¯å¢ƒå˜é‡ã€ç«¯å£é…ç½®
- âœ… **è‡ªåŠ¨æ‰©ç¼©å®¹**ï¼šæ ¹æ®è´Ÿè½½è°ƒæ•´å®ä¾‹æ•°
- âœ… **æ—¥å¿—æ”¶é›†**ï¼šç»Ÿä¸€æ—¥å¿—ç®¡ç†

**å¯¹å¤–æ¥å£**ï¼š
```javascript
window.DeployBlock = {
    /**
     * è·å–éƒ¨ç½²çŠ¶æ€
     * @returns {Promise<DeploymentStatus>}
     */
    getDeploymentStatus: async () => {
        return {
            success: true,
            data: {
                services: [
                    {
                        name: "qa-frontend",
                        status: "running|stopped|error",
                        health: "healthy|unhealthy|unknown",
                        uptime: 86400, // ç§’
                        cpu: 15.6, // ç™¾åˆ†æ¯”
                        memory: "256MB",
                        restartCount: 0
                    },
                    {
                        name: "qa-backend", 
                        status: "running",
                        health: "healthy",
                        uptime: 86400,
                        cpu: 25.3,
                        memory: "512MB",
                        restartCount: 1
                    }
                ],
                totalUptime: 86400,
                lastHealthCheck: "2024-12-31T10:30:00Z"
            }
        };
    },

    /**
     * é‡å¯æœåŠ¡ï¼ˆå¢åŠ æƒé™æ ¡éªŒï¼‰
     * @param {string} serviceName - æœåŠ¡åç§°
     * @returns {Promise<RestartResult>}
     */
    restartService: async (serviceName) => {
        // åŸºç¡€æƒé™æ ¡éªŒï¼šåªæœ‰ç®¡ç†å‘˜èƒ½é‡å¯æœåŠ¡
        const currentUser = AuthBlock.getCurrentUser();
        if (!currentUser || currentUser.role !== 'admin') {
            return {
                success: false,
                error: "æƒé™ä¸è¶³ï¼Œä»…ç®¡ç†å‘˜å¯é‡å¯æœåŠ¡"
            };
        }

        const validServices = ['qa-frontend', 'qa-backend', 'mysql'];
        if (!validServices.includes(serviceName)) {
            return {
                success: false,
                error: `æ— æ•ˆçš„æœåŠ¡åç§°ï¼Œå¿…é¡»æ˜¯: ${validServices.join(', ')}`
            };
        }

        return {
            success: true,
            data: {
                serviceName: serviceName,
                restartStartedAt: "2024-12-31T10:30:00Z",
                restartCompletedAt: "2024-12-31T10:30:15Z",
                downtime: 15, // ç§’
                newContainerId: "container_id"
            }
        };
    },

    /**
     * è·å–ç³»ç»ŸæŒ‡æ ‡
     * @returns {Promise<SystemMetrics>}
     */
    getSystemMetrics: async () => {
        return {
            success: true,
            data: {
                system: {
                    cpu: {
                        usage: 45.6, // ç™¾åˆ†æ¯”
                        cores: 4,
                        loadAverage: [1.2, 1.5, 1.8]
                    },
                    memory: {
                        total: "8GB",
                        used: "3.2GB", 
                        available: "4.8GB",
                        usage: 40.0 // ç™¾åˆ†æ¯”
                    },
                    disk: {
                        total: "100GB",
                        used: "25GB",
                        available: "75GB",
                        usage: 25.0
                    }
                },
                network: {
                    rx: "1.2MB/s",
                    tx: "0.8MB/s"
                },
                collectedAt: "2024-12-31T10:30:00Z"
            }
        };
    },

    /**
     * æ›´æ–°é…ç½®ï¼ˆå¢åŠ æƒé™æ ¡éªŒï¼‰
     * @param {ConfigData} configData - é…ç½®æ•°æ®
     * @returns {Promise<ConfigResult>}
     */
    updateConfig: async (configData) => {
        // åŸºç¡€æƒé™æ ¡éªŒï¼šåªæœ‰ç®¡ç†å‘˜èƒ½æ›´æ–°é…ç½®
        const currentUser = AuthBlock.getCurrentUser();
        if (!currentUser || currentUser.role !== 'admin') {
            return {
                success: false,
                error: "æƒé™ä¸è¶³ï¼Œä»…ç®¡ç†å‘˜å¯æ›´æ–°é…ç½®"
            };
        }

        // é…ç½®æ•°æ®æ ¼å¼ï¼š
        const config = {
            environment: {
                DATABASE_URL: "mysql://...",
                API_BASE_URL: "http://localhost:8000",
                LOG_LEVEL: "info|debug|error"
            },
            scaling: {
                frontend: {
                    replicas: 1,
                    maxCpu: "200m",
                    maxMemory: "256Mi"
                },
                backend: {
                    replicas: 1,
                    maxCpu: "500m", 
                    maxMemory: "512Mi"
                }
            }
        };

        return {
            success: true,
            data: {
                updatedAt: "2024-12-31T10:30:00Z",
                changedServices: ["qa-backend"],
                restartRequired: true,
                backupCreated: "config_backup_20241231.yaml"
            }
        };
    }
};
```

**Dockeré…ç½®ç¤ºä¾‹**ï¼š
```yaml
# docker-compose.yml
version: '3.8'
services:
  qa-frontend:
    build: ./frontend
    ports:
      - "3000:80"
    depends_on:
      - qa-backend
      
  qa-backend:
    build: ./backend
    ports:
      - "8000:8000"
    environment:
      - DATABASE_URL=mysql://qa_user:qa_password@mysql:3306/qa_db
    depends_on:
      - mysql
      
  mysql:
    image: mysql:8.0
    environment:
      MYSQL_DATABASE: qa_db
      MYSQL_USER: qa_user
      MYSQL_PASSWORD: qa_password
    volumes:
      - mysql_data:/var/lib/mysql

volumes:
  mysql_data:
```

---

## ğŸ”— **ä¿®æ­£åçš„å—é—´é€šä¿¡æœºåˆ¶**

### **ç®€åŒ–çš„è°ƒç”¨å…³ç³»**
```
UIBlock (ç•Œé¢åè°ƒ)
    â†“ è°ƒç”¨
AuthBlock (è®¤è¯) â†â†’ QANoteBlock (é—®ç­”ç¬”è®°ç»Ÿä¸€) â†â†’ DeployBlock (éƒ¨ç½²ç®¡ç†)
```

### **æ°´å¹³é€šä¿¡ï¼ˆå¹³ç­‰å…³ç³»ï¼‰**
```javascript
// æ ¸å¿ƒå·¥ä½œæµç¨‹
if (!AuthBlock.isLoggedIn()) {
    UIBlock.switchToBlock('auth');
} else {
    UIBlock.switchToBlock('qa-note');
    QANoteBlock.switchMode('qa'); // é»˜è®¤é—®ç­”æ¨¡å¼
}

// é—®ç­”å®Œæˆåè‡ªåŠ¨ä¿å­˜ä¸ºç¬”è®°
QANoteBlock.askQuestion(title, content, agentId, tags).then(result => {
    // è‡ªåŠ¨åˆ‡æ¢åˆ°ç¬”è®°æ¨¡å¼å¹¶ä¿å­˜
    QANoteBlock.switchMode('note');
    QANoteBlock.saveNote(title, result.answer, tags);
});
```

### **äº‹ä»¶é©±åŠ¨é€šä¿¡**
```javascript
// ç™»å½•æˆåŠŸååˆ‡æ¢åˆ°é—®ç­”ç¬”è®°
document.addEventListener('user-login', (e) => {
    UIBlock.switchToBlock('qa-note');
});

// éƒ¨ç½²çŠ¶æ€å˜åŒ–é€šçŸ¥
document.addEventListener('deployment-status-change', (e) => {
    UIBlock.showMessage(`æœåŠ¡çŠ¶æ€: ${e.detail.status}`, 'info');
});
```

---

## ğŸš€ **ä¿®æ­£åçš„å¼€å‘é¡ºåº**

### **å¹¶è¡Œå¼€å‘æ–¹æ¡ˆ**
```bash
# 3ä¸ªæ ¸å¿ƒå—å¯ä»¥å¹¶è¡Œå¼€å‘
å¼€å‘è€…A: AuthBlock      (auth.html + auth.css + auth.js)
å¼€å‘è€…B: QANoteBlock    (qa-note.html + qa-note.css + qa-note.js)  
å¼€å‘è€…C: UIBlock        (index.html + main.css + main.js)

# éƒ¨ç½²å—åæœŸé›†æˆ
å¼€å‘è€…D: DeployBlock    (dockerç›¸å…³é…ç½® + éƒ¨ç½²è„šæœ¬)
```

### **é›†æˆæµ‹è¯•é¡ºåº**
```bash
1. æµ‹è¯• AuthBlock: ç›´æ¥æ‰“å¼€ auth.html
2. æµ‹è¯• QANoteBlock: ç›´æ¥æ‰“å¼€ qa-note.html (åŒ…å«æ¨¡å¼åˆ‡æ¢æµ‹è¯•)
3. æµ‹è¯• UIBlock: é€šè¿‡ index.html åè°ƒå‰ä¸¤ä¸ªå—
4. æµ‹è¯• DeployBlock: Dockerå®¹å™¨åŒ–éƒ¨ç½²æµ‹è¯•
```

---

## ğŸ›¡ï¸ **é˜²AIå‘ç—…æœºåˆ¶å‡çº§**

### **1. ç»Ÿä¸€åŠŸèƒ½è¾¹ç•Œ**
```javascript
/**
 * QANoteBlock - é—®ç­”å’Œç¬”è®°ç»Ÿä¸€åŠŸèƒ½
 * æ ¸å¿ƒï¼šç›¸åŒçš„è¾“å…¥ç•Œé¢ (title, content, tags)
 * åŒºåˆ«ï¼šé€šè¿‡modeå‚æ•°åŒºåˆ†å¤„ç†é€»è¾‘
 * ç¦æ­¢ï¼šç”¨æˆ·è®¤è¯ã€ç•Œé¢åˆ‡æ¢ã€éƒ¨ç½²ç®¡ç†
 * å…è®¸ï¼šé—®ç­”å¤„ç†ã€ç¬”è®°å­˜å‚¨ã€æ¨¡å¼åˆ‡æ¢
 */
```

### **2. æ¨¡å¼åˆ‡æ¢éªŒè¯**
```javascript
// ç¡®ä¿AIç†è§£è¿™æ˜¯åŒä¸€ä¸ªç•Œé¢çš„ä¸åŒæ¨¡å¼
function validateMode(mode) {
    if (!['qa', 'note'].includes(mode)) {
        throw new Error('Invalid mode: must be "qa" or "note"');
    }
    // å…±äº«ç›¸åŒçš„è¾“å…¥æ¡†ï¼Œåªæ”¹å˜å¤„ç†é€»è¾‘
    return true;
}
```

### **3. éƒ¨ç½²é…ç½®æ ‡å‡†åŒ–**
```javascript
// é˜²æ­¢AIéšæ„ä¿®æ”¹ç«¯å£å’Œé…ç½®
const DEPLOYMENT_CONFIG = {
    FRONTEND_PORT: 3000,  // å›ºå®šå‰ç«¯ç«¯å£
    BACKEND_PORT: 8000,   // å›ºå®šåç«¯ç«¯å£
    DATABASE_PORT: 3306,  // å›ºå®šæ•°æ®åº“ç«¯å£
    ALLOWED_MODES: ['qa', 'note'],  // å…è®¸çš„æ¨¡å¼
    REQUIRED_BLOCKS: ['auth', 'qa-note', 'ui']  // å¿…éœ€çš„å—
};
```

---

## ğŸ“Š **ä¿®æ­£æ–¹æ¡ˆä¼˜åŠ¿å¯¹æ¯”**

| å¯¹æ¯”é¡¹ | åŸ4å—æ–¹æ¡ˆ | ä¿®æ­£3+1å—æ–¹æ¡ˆ |
|--------|-----------|---------------|
| **åŠŸèƒ½ç»Ÿä¸€æ€§** | é—®ç­”ç¬”è®°åˆ†ç¦»âŒ | é—®ç­”ç¬”è®°ç»Ÿä¸€âœ… |
| **ç•Œé¢å¤æ‚åº¦** | å¤šä¸ªç‹¬ç«‹ç•Œé¢ | ç»Ÿä¸€ç•Œé¢åˆ‡æ¢âœ… |
| **AIç†è§£åº¦** | å®¹æ˜“æ··æ·†è¾¹ç•Œ | åŠŸèƒ½è¾¹ç•Œæ¸…æ™°âœ… |
| **éƒ¨ç½²ç®¡ç†** | ç¼ºå¤±âŒ | å®Œæ•´æ”¯æŒâœ… |
| **å¼€å‘æ•ˆç‡** | 4å—å¹¶è¡Œ | 3å—å¹¶è¡Œ+éƒ¨ç½²âœ… |
| **ç»´æŠ¤æˆæœ¬** | å¤šç•Œé¢ç»´æŠ¤ | ç»Ÿä¸€ç•Œé¢ç»´æŠ¤âœ… |

---

## âœ… **ä¿®æ­£æ–¹æ¡ˆæ€»ç»“**

**ä¿®æ­£è¦ç‚¹**ï¼š
1. **åˆå¹¶é—®ç­”ç¬”è®°å—**ï¼šç¬¦åˆv2.0ç»Ÿä¸€ç•Œé¢è®¾è®¡ç†å¿µ
2. **å¢åŠ éƒ¨ç½²ç®¡ç†å—**ï¼šæ”¯æŒDockerå®¹å™¨åŒ–éƒ¨ç½²
3. **ç®€åŒ–å—é—´å…³ç³»**ï¼šå‡å°‘AIæ··æ·†çš„å¯èƒ½æ€§
4. **ä¿æŒæ¨¡å¼åˆ‡æ¢**ï¼šåœ¨ç»Ÿä¸€ç•Œé¢å†…åˆ‡æ¢åŠŸèƒ½æ¨¡å¼

**æœ€ç»ˆæ¶æ„**ï¼š
```
AuthBlock â†â†’ QANoteBlock â†â†’ UIBlock
              â†“
          DeployBlock
```

**è¿™æ‰æ˜¯ç¬¦åˆéœ€æ±‚çš„æ­£ç¡®è§£è€¦æ–¹æ¡ˆï¼** ğŸ¯ 

---

## ğŸ”’ **é’ˆå¯¹è¯„å®¡å»ºè®®çš„æ€åº¦æ˜ç¡®ä¿®æ­£**

### **é¡¹ç›®å®šä½é‡ç”³**
- **ç”¨æˆ·è§„æ¨¡**ï¼š100-200äººè‡ªç”¨ç³»ç»Ÿ
- **è®¾è®¡åŸåˆ™**ï¼šç®€å•æœ‰æ•ˆï¼Œé¿å…è¿‡åº¦å·¥ç¨‹åŒ–
- **ç›®æ ‡**ï¼šå¿«é€Ÿè¿­ä»£å’Œç¨³å®šè¿è¡Œï¼Œä¸æ˜¯æ¶æ„è‰ºæœ¯å“

---

## âœ… **å¿…é¡»ä¿®æ­£ï¼šéƒ¨ç½²å®‰å…¨é—®é¢˜**

### **é—®é¢˜**ï¼š`DeployBlock.restartService()` ç¼ºå°‘æƒé™æ ¡éªŒ

### **ç®€åŒ–è§£å†³æ–¹æ¡ˆ**ï¼š
```javascript
window.DeployBlock = {
    /**
     * é‡å¯æœåŠ¡ï¼ˆå¢åŠ æƒé™æ ¡éªŒï¼‰
     * @param {string} serviceName - æœåŠ¡åç§°
     * @returns {Promise<RestartResult>}
     */
    restartService: async (serviceName) => {
        // åŸºç¡€æƒé™æ ¡éªŒï¼šåªæœ‰ç®¡ç†å‘˜èƒ½é‡å¯æœåŠ¡
        const currentUser = AuthBlock.getCurrentUser();
        if (!currentUser || currentUser.role !== 'admin') {
            return {
                success: false,
                error: "æƒé™ä¸è¶³ï¼Œä»…ç®¡ç†å‘˜å¯é‡å¯æœåŠ¡"
            };
        }

        const validServices = ['qa-frontend', 'qa-backend', 'mysql'];
        if (!validServices.includes(serviceName)) {
            return {
                success: false,
                error: `æ— æ•ˆçš„æœåŠ¡åç§°ï¼Œå¿…é¡»æ˜¯: ${validServices.join(', ')}`
            };
        }

        return {
            success: true,
            data: {
                serviceName: serviceName,
                restartStartedAt: "2024-12-31T10:30:00Z",
                restartCompletedAt: "2024-12-31T10:30:15Z",
                downtime: 15, // ç§’
                newContainerId: "container_id"
            }
        };
    },

    /**
     * æ›´æ–°é…ç½®ï¼ˆå¢åŠ æƒé™æ ¡éªŒï¼‰
     * @param {ConfigData} configData - é…ç½®æ•°æ®
     * @returns {Promise<ConfigResult>}
     */
    updateConfig: async (configData) => {
        // åŸºç¡€æƒé™æ ¡éªŒï¼šåªæœ‰ç®¡ç†å‘˜èƒ½æ›´æ–°é…ç½®
        const currentUser = AuthBlock.getCurrentUser();
        if (!currentUser || currentUser.role !== 'admin') {
            return {
                success: false,
                error: "æƒé™ä¸è¶³ï¼Œä»…ç®¡ç†å‘˜å¯æ›´æ–°é…ç½®"
            };
        }

        // ... å…¶ä½™é…ç½®æ›´æ–°é€»è¾‘ä¿æŒä¸å˜
        return {
            success: true,
            data: {
                updatedAt: "2024-12-31T10:30:00Z",
                changedServices: ["qa-backend"],
                restartRequired: true,
                backupCreated: "config_backup_20241231.yaml"
            }
        };
    }
};
```

---

## âŒ **åšå†³ä¸é‡‡çº³ï¼šè¿‡åº¦å·¥ç¨‹åŒ–å»ºè®®**

### **1. UIBlockæ‹†åˆ†å»ºè®® - å®Œå…¨æ²¡å¿…è¦**
**è¯„å®¡å»ºè®®**ï¼šå°†æ¶ˆæ¯æç¤ºã€å“åº”å¼å¸ƒå±€æ‹†åˆ†ä¸ºç‹¬ç«‹æ¨¡å—
**æˆ‘ä»¬çš„æ€åº¦**ï¼š**æ‹’ç»ï¼è¿™æ˜¯å…¸å‹çš„è¿‡åº¦è®¾è®¡**

**ç†ç”±**ï¼š
- 100-200äººç³»ç»Ÿï¼ŒUIBlockå½“å‰èŒè´£å®Œå…¨åˆç†
- æ‹†åˆ†ä¼šå¢åŠ å¤æ‚åº¦ï¼Œè¿èƒŒ"ç®€å•æœ‰æ•ˆ"åŸåˆ™  
- æ¶ˆæ¯æç¤ºæœ¬å°±æ˜¯ç•Œé¢åè°ƒçš„è‡ªç„¶ç»„æˆéƒ¨åˆ†

### **2. å¤æ‚é”™è¯¯ç ä½“ç³» - çº¯å±æµªè´¹**
**è¯„å®¡å»ºè®®**ï¼šå¼•å…¥`ERR_AUTH_001`ç­‰ä¼ä¸šçº§é”™è¯¯ç 
**æˆ‘ä»¬çš„æ€åº¦**ï¼š**å®Œå…¨å¤šä½™ï¼**

**ä¿æŒç°çŠ¶**ï¼š
```javascript
// æˆ‘ä»¬çš„ç®€å•æœ‰æ•ˆæ–¹å¼ï¼š
{
    success: false,
    error: "ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯"  // ç›´ç™½æ˜äº†
}

// æ‹’ç»è¿™ç§å¤æ‚æ€§ï¼š
{
    success: false,
    code: "ERR_AUTH_001", 
    message: "Authentication failed",
    details: "Invalid credentials provided"
}
```

### **3. å¤æ‚äº‹ä»¶ç³»ç»Ÿ - å®Œå…¨å¤šä½™**
**è¯„å®¡å»ºè®®**ï¼šä½¿ç”¨`document.addEventListener('auth-status-change')`
**æˆ‘ä»¬çš„æ€åº¦**ï¼š**ç›´æ¥è°ƒç”¨ä¸é¦™å—ï¼Ÿ**

**ä¿æŒç®€å•**ï¼š
```javascript
// ç®€å•ç›´æ¥çš„æ–¹å¼ï¼š
if (AuthBlock.isLoggedIn()) {
    UIBlock.switchToBlock('qa-note');
}

// ä¸éœ€è¦å¤æ‚çš„äº‹ä»¶ç›‘å¬ç³»ç»Ÿ
```

---

## ğŸ”„ **å¯é€‰ä¼˜åŒ–ï¼šç®€å•é‡è¯•æœºåˆ¶**

### **é—®é¢˜**ï¼šè‡ªåŠ¨ä¿å­˜å¤±è´¥çš„å›é€€å¤„ç†
### **ç®€åŒ–æ–¹æ¡ˆ**ï¼š
```javascript
// QANoteBlock ä¸­å¢åŠ ç®€å•é‡è¯•
async saveNote(noteData) {
    try {
        return await this.doSave(noteData);
    } catch (error) {
        // ç®€å•é‡è¯•ä¸€æ¬¡å°±å¤Ÿäº†
        try {
            return await this.doSave(noteData);
        } catch (retryError) {
            return {
                success: false,
                error: "ä¿å­˜å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥åé‡è¯•"
            };
        }
    }
}
```

---

## ğŸ“Š **æœ€ç»ˆè¯„åˆ†ä¿®æ­£**

**è¯„å®¡ç»™åˆ†**ï¼š85/100
**æˆ‘ä»¬çš„è¯„åˆ†**ï¼š**90/100**

**ä¿®æ­£ç†ç”±**ï¼š
- è¯„å®¡è€…ç”¨**å¤§å‹ä¼ä¸šç³»ç»Ÿæ ‡å‡†**è¡¡é‡**å°å‹è‡ªç”¨ç³»ç»Ÿ**
- å¾ˆå¤š"ç¼ºé™·"å®é™…ä¸Šæ˜¯**åˆç†çš„ç®€åŒ–è®¾è®¡**
- å®‰å…¨é—®é¢˜ç¡®å®å­˜åœ¨ï¼Œä½†**ä¿®å¤æˆæœ¬æä½**

---

## ğŸ¯ **æœ€ç»ˆæ‰§è¡Œæ€åº¦**

### **åšæŒç®€å•åŸåˆ™**
1. âœ… **ä¿®å¤å®‰å…¨é—®é¢˜**ï¼šå¢åŠ åŸºç¡€æƒé™æ ¡éªŒï¼ˆ5åˆ†é’Ÿå·¥ä½œé‡ï¼‰
2. âŒ **æ‹’ç»è¿‡åº¦å·¥ç¨‹åŒ–**ï¼šä¸æ‹†åˆ†UIBlockï¼Œä¸å¼•å…¥å¤æ‚é”™è¯¯ç 
3. ğŸ”„ **é€‰æ‹©æ€§ä¼˜åŒ–**ï¼šç®€å•é‡è¯•æœºåˆ¶ï¼ˆå¯é€‰ï¼‰

### **å®äº‹æ±‚æ˜¯çš„ç»“è®º**
- å½“å‰è§£è€¦æ–¹æ¡ˆå¯¹**100-200äººè§„æ¨¡**ç³»ç»Ÿ**åˆšåˆšå¥½**
- æ—¢é¿å…äº†AIå‘ç—…ï¼Œåˆæ²¡æœ‰è¿‡åº¦å¤æ‚åŒ–
- ä¿ç•™äº†å¿…è¦çš„æ‰©å±•æ€§

**æ ¸å¿ƒæ€åº¦**ï¼š**æˆ‘ä»¬æŒ‰ç°æœ‰æ–¹æ¡ˆæ‰§è¡Œï¼ŒåªåŠ åŸºç¡€æƒé™æ ¡éªŒï¼Œå…¶ä»–è¿‡åº¦å·¥ç¨‹åŒ–å»ºè®®ç»Ÿç»Ÿå¿½ç•¥ï¼**

**100-200äººçš„è‡ªç”¨ç³»ç»Ÿï¼Œè¿½æ±‚çš„æ˜¯å¿«é€Ÿè¿­ä»£å’Œç¨³å®šè¿è¡Œï¼Œä¸æ˜¯ç»™æ¶æ„å¸ˆç‚«æŠ€ç”¨çš„ï¼** âœ… 