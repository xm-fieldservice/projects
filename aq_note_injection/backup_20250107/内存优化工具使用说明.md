# Cursor 内存优化工具使用说明

## 📁 工具文件概览

| 文件名 | 说明 | 权限要求 |
|--------|------|----------|
| `内存优化清理工具_改进版.bat` | 完整版优化工具，自动请求管理员权限 | 管理员权限 |
| `内存优化清理工具_改进版_备份.bat` | 原始版本备份文件 | 管理员权限 |
| `快速内存优化.bat` | 轻量版优化工具，无需管理员权限 | 普通用户权限 |

## 🚀 快速开始

### 方法一：自动提权（推荐）
1. 双击 `内存优化清理工具_改进版.bat`
2. 工具会自动请求管理员权限
3. 在UAC提示中点击"是"
4. 等待优化完成

### 方法二：手动提权
1. 右键 `内存优化清理工具_改进版.bat`
2. 选择"以管理员身份运行"
3. 等待优化完成

### 方法三：无权限快速优化
1. 双击 `快速内存优化.bat`
2. 直接运行基础优化
3. 无需管理员权限

## 🔧 功能详解

### 完整版功能 (`内存优化清理工具_改进版.bat`)

#### 1. 自动权限管理
- ✅ 自动检测管理员权限
- ✅ 自动请求UAC提权
- ✅ 提权失败时给出手动操作指导

#### 2. 内存优化功能
- 🧹 系统垃圾回收
- 💾 工作集内存优化（使用Win32 API）
- 🗑️ Cursor缓存文件清理
- 🔄 TypeScript服务器重启
- 🗂️ 系统临时文件清理
- 📦 内存整理和压缩
- ⚡ 进程优先级优化

#### 3. 智能监控
- 📊 优化前后内存对比
- 📈 实时进程内存显示
- 🎯 系统内存使用率分析
- ✅ 优化效果评估

#### 4. 自动化功能
- ⏰ 可设置定时任务（每2小时）
- 🔗 自动创建桌面快捷方式
- 📝 详细优化报告

### 轻量版功能 (`快速内存优化.bat`)

#### 基础优化功能
- 🧹 系统垃圾回收
- 🗑️ 临时文件清理
- 📄 Cursor日志清理
- 💾 基础内存工作集优化
- 📊 内存使用情况显示

## 🎯 使用场景

### 何时使用完整版？
- Cursor运行缓慢，内存占用过高
- 需要深度优化和系统级清理
- 希望设置自动化定时清理
- 追求最佳优化效果

### 何时使用轻量版？
- 快速临时优化
- 没有管理员权限
- 只需基础内存清理
- 频繁使用的日常优化

## 📊 优化效果

### 预期效果
- 💾 内存使用减少：30-50%
- ⚡ 响应速度提升：明显改善
- 🚀 AI自动完成：保持流畅
- 🔄 无需重启：立即生效

### 优化指标
| 内存使用率 | 状态 | 建议 |
|------------|------|------|
| < 80% | 🟢 正常 | 定期维护 |
| 80-90% | 🟡 较高 | 增加清理频率 |
| > 90% | 🔴 过高 | 立即清理或重启 |

## ⚠️ 注意事项

### 使用前
1. 建议保存当前工作内容
2. 确保Cursor没有正在执行重要任务
3. 关闭不必要的扩展

### 权限问题
- Windows 10/11：通常需要UAC确认
- 企业环境：可能需要IT管理员权限
- 受限账户：使用轻量版工具

### 兼容性
- ✅ Windows 10/11
- ✅ PowerShell 5.0+
- ✅ Cursor 所有版本
- ⚠️ 企业版Windows可能有策略限制

## 🔍 故障排除

### 问题1：PowerShell执行策略错误
**现象：** 提示"执行策略更改"
**解决方案：**
```cmd
# 以管理员身份运行PowerShell
Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser
```

### 问题2：UAC提权失败
**现象：** 自动提权不成功
**解决方案：**
1. 手动右键"以管理员身份运行"
2. 或在管理员命令提示符中运行：
```cmd
cmd /c "完整路径\内存优化清理工具_改进版.bat"
```

### 问题3：找不到Cursor进程
**现象：** 显示"未找到Cursor进程"
**解决方案：**
1. 确认Cursor已启动
2. 检查进程名是否为"Cursor.exe"
3. 重启Cursor后再试

### 问题4：权限不足错误
**现象：** 某些操作失败
**解决方案：**
1. 使用管理员权限运行
2. 或使用轻量版工具
3. 检查企业安全策略

## 🛠️ 高级配置

### 定时任务设置
工具可自动创建定时任务，设置为每2小时运行一次：
- 任务名：`Cursor内存优化`
- 频率：每2小时
- 权限：最高权限运行

### 手动定时任务
```cmd
# 创建定时任务
schtasks /create /tn "Cursor内存优化" /tr "完整路径\内存优化清理工具_改进版.bat" /sc hourly /mo 2 /f /rl highest

# 删除定时任务
schtasks /delete /tn "Cursor内存优化" /f
```

### 快捷键设置
1. 创建桌面快捷方式
2. 右键快捷方式 → 属性
3. 在"快捷键"字段设置组合键（如Ctrl+Alt+M）

## 📞 技术支持

### 日志位置
- 系统事件：Windows事件查看器
- PowerShell错误：在命令窗口显示
- Cursor日志：`%APPDATA%\Cursor\logs`

### 性能监控
建议使用以下工具监控效果：
- Windows任务管理器
- 资源监视器
- Process Explorer

### 联系支持
如遇到问题，请提供：
1. Windows版本信息
2. Cursor版本
3. 错误截图或日志
4. 系统配置信息

---

**最后更新：** 2024年12月
**工具版本：** v2.1 自动提权版 